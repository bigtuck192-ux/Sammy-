import{j as e,r,R as Ke}from"./react-BOYD0Eae.js";import{c as vt}from"./react-dom-D6QFreEl.js";import{I as wt,a as yt,F as jt,b as St,c as Nt,d as Tt,e as et,f as kt,g as Et,h as _t,i as Lt,j as tt,k as ke,l as Mt,m as At,n as Pt,o as zt,p as Dt,q as It,r as Rt,s as Se,t as _e,u as $t,v as Gt,w as Te,x as Ot,y as Ft,T as Bt,z as Kt}from"./react-icons-htnwMEOV.js";import{l as Wt,S as Ht}from"./socket.io-client-D2F1JntD.js";import{v as Ut}from"./uuid-DvF23Exx.js";import{M as Vt}from"./react-markdown-CZ6Seur3.js";import{h as at,v as lt}from"./react-syntax-highlighter-BzuSNXZg.js";import{C as Jt}from"./ansi-to-html-TIwthtE6.js";import{x as qt}from"./xterm-DQVPUG18.js";import{x as Yt}from"./xterm-addon-fit-CECnk2lm.js";import{_ as Xt}from"./react-ace-8ncE7_VW.js";import"./ace-builds-zox5IqHp.js";import"./scheduler-CzFDRTuY.js";import"./engine.io-client-C44f3zIw.js";import"./engine.io-parser-BiEtp6m2.js";import"./@socket.io-Dkula2eQ.js";import"./socket.io-parser-BBkuslX-.js";import"./devlop-Cl3hj7Sz.js";import"./unified-CaLNyFq2.js";import"./bail-FqpXQuLt.js";import"./extend-BQXuF5v6.js";import"./is-plain-obj-C1gvLhAf.js";import"./trough-B_b8ryxu.js";import"./vfile-tbz-BywF.js";import"./vfile-message-Bq256rVA.js";import"./unist-util-stringify-position-Ch_qCilz.js";import"./remark-parse-BrXu98zB.js";import"./mdast-util-from-markdown-CeHMh-rK.js";import"./micromark-util-decode-numeric-character-reference-CNs1qBpV.js";import"./micromark-util-decode-string-strjl-tx.js";import"./decode-named-character-reference-C3-224fz.js";import"./micromark-util-normalize-identifier-C9ANKk3v.js";import"./micromark-DTlTLvYZ.js";import"./micromark-util-combine-extensions-Bka6Sc1c.js";import"./micromark-util-chunked-DrRIdSP-.js";import"./micromark-factory-space-CA-Wq7KA.js";import"./micromark-util-character-Ch8j4vtg.js";import"./micromark-core-commonmark-DGH4vyL8.js";import"./micromark-util-classify-character-GCpR5yWH.js";import"./micromark-util-resolve-all-PQCKh0dx.js";import"./micromark-util-subtokenize-Bdv1B1ce.js";import"./micromark-factory-destination-CkgxUJuk.js";import"./micromark-factory-label-U15tx9Nh.js";import"./micromark-factory-title-reCpaPbc.js";import"./micromark-factory-whitespace-_v4v79HM.js";import"./micromark-util-html-tag-name-DbKNfynz.js";import"./mdast-util-to-string-C_aolqmU.js";import"./remark-rehype-1Bk2Q172.js";import"./mdast-util-to-hast-BfaRxxVW.js";import"./@ungap-DDJC10qW.js";import"./micromark-util-sanitize-uri-WGc3xW3f.js";import"./unist-util-position-60F3QETU.js";import"./trim-lines-D8znQY54.js";import"./unist-util-visit-DGoE-dKL.js";import"./unist-util-visit-parents-BC5uWo4u.js";import"./unist-util-is-D9KQvrmg.js";import"./hast-util-to-jsx-runtime-BT3ISMAz.js";import"./comma-separated-tokens-xMQ5YY98.js";import"./property-information-C2mYTYrW.js";import"./space-separated-tokens-DD3iYX1K.js";import"./style-to-object-DUIdZ64S.js";import"./inline-style-parser-D--Rb2MU.js";import"./hast-util-whitespace-D4Wp6AEg.js";import"./estree-util-is-identifier-name-BgBfM8ME.js";import"./html-url-attributes-D46m5wfe.js";import"./refractor-DMBKtE-C.js";import"./hastscript-CufpaJpy.js";import"./xtend-CeaPpq3n.js";import"./hast-util-parse-selector-Cqsfuk9Y.js";import"./@babel-D7QzmyDV.js";import"./entities-CgcPRAwt.js";import"./prop-types-BKNjMPK8.js";import"./lodash.isequal-UfDCfVYe.js";import"./lodash.get-5suVfKIr.js";import"./diff-match-patch-CVofqCa5.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=s(a);fetch(a.href,i)}})();function Zt({src:t,alt:o,fallback:s,className:n="",size:a="md"}){const i={sm:"w-8 h-8",md:"w-10 h-10",lg:"w-12 h-12"};return e.jsx("div",{className:`relative inline-block ${i[a]} ${n}`,children:t?e.jsx("img",{src:t,alt:o||"",className:"rounded-full w-full h-full object-cover"}):e.jsx("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-[--orangeColor] text-[--primaryTextColor] font-medium",style:{fontSize:a==="lg"?"1.25rem":"1rem"},children:s})})}function Qt({socket:t,isConnected:o,sendMessage:s}){var N;const[n,a]=r.useState(null),[i,l]=r.useState(!1),[m,d]=r.useState(null);r.useEffect(()=>{const G=localStorage.getItem("session_token");G&&t.emit("get_user_details",{session_token:G});const L=P=>{P?(a(P),l(!0)):l(!1)};return t.on("user_details",L),()=>{t.off("user_details",L)}},[]);const p=()=>{localStorage.removeItem("session_token"),localStorage.removeItem("selected"),a(null),l(!1)},w=()=>{A("https://auth.codemate.ai/?run=connect&host=cli")},A=G=>{window.electron.openExternalLink(G).then(L=>{}).catch(L=>{console.error("Error opening URL:",L)})};return r.useEffect(()=>(t&&(t.on("user_authenticate_token",async G=>{const L=G.session_token;L&&(localStorage.setItem("session_token",L),d(L),localStorage.setItem("selected",JSON.stringify(!0)),t.emit("get_user_details",{session_token:L}))}),t.on("user_details",G=>{G?(a(G),l(!0)):l(!1)})),()=>{t&&(t.off("user_authenticate_token"),t.off("user_details"))}),[t]),e.jsxs("div",{className:"overflow-y-auto w-3/4 p-4 max-h-[552px] hide-scrollbar",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-6",children:"Account"}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx(Zt,{fallback:((N=n==null?void 0:n.name)==null?void 0:N[0])||"AI",size:"lg",src:n==null?void 0:n.image}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:n!=null&&n.name?n.name:n?"Your Account":"Guest Account"}),e.jsx("p",{className:"text-[--grayColor] text-sm",children:(n==null?void 0:n.email)||"Sign in for more features"})]}),i&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-[--scrollbarTrackColor] text-[--grayColor] text-xs rounded",children:(n==null?void 0:n.plan)||"Free Plan"}),e.jsx("button",{className:"text-[--darkBlueColorGradientStart] text-sm hover:underline",onClick:()=>window.electron.openExternalLink("https://codemate.ai/#pricing"),children:"Compare plans"})]})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[--grayColor] text-sm",children:"Version"}),e.jsx("button",{className:"text-[--darkBlueColorGradientStart] text-sm hover:underline",children:"Check for updates"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("code",{className:"text-sm text-[--grayColor]",children:"v0.0.1"}),e.jsx("span",{className:"text-[--grayColor] text-xs",children:"Up to date"})]})]}),i?e.jsx("button",{onClick:p,className:"px-4 py-2 bg-[--scrollbarTrackColor] text-[--primaryTextColor] rounded hover:bg-[--darkGrayColor] transition-colors",children:"Log out"}):e.jsx("button",{onClick:w,className:"px-4 py-2 bg-[--scrollbarTrackColor] text-[--primaryTextColor] rounded hover:bg-[--darkGrayColor] transition-colors",children:"Log In"})]})]})}const it=t=>{const[o,s]=r.useState(null),[n,a]=r.useState(!1);r.useEffect(()=>{const l=Wt(t);return l.on("connect",()=>{a(!0)}),l.on("disconnect",()=>{a(!1)}),s(l),()=>{l.disconnect()}},[t]);const i=r.useCallback((l,m)=>{o&&o.emit(l,m)},[o]);return{socket:o,isConnected:n,sendMessage:i}},ct=r.createContext(void 0),rt=["codemate-ai-dark","codemate-ai-light","modern-terminal","dracula","gruvbox-dark"],er=({children:t})=>{const{socket:o,isConnected:s}=it("http://127.0.0.1:5000/"),[n,a]=r.useState(rt),i=()=>{const g=localStorage.getItem("themes");return g?JSON.parse(g):rt};r.useEffect(()=>{const g=localStorage.getItem("theme");g?(document.documentElement.classList.remove(`${p}-theme`),document.documentElement.classList.add(`${g}-theme`),w(g)):w("codemate-ai-dark")},[]);const l=g=>{if(!g)return;const D=[...n,g];a(D),localStorage.setItem("themes",JSON.stringify(D))};r.useEffect(()=>{const g=i();a(g)},[]);const[m,d]=r.useState(["codemate-ai-dark","codemate-ai-light"]),[p,w]=r.useState(""),[A,N]=r.useState({});r.useEffect(()=>{const g=JSON.parse(localStorage.getItem("customColors")||"null");g&&(N(g),G(g))},[]),r.useEffect(()=>{const g=localStorage.getItem("theme");w(g||"codemate-ai-dark")},[]);const G=g=>{const D=document.documentElement;Object.keys(g).forEach(W=>{D.style.setProperty(`--${W}`,g[W])}),N(g),localStorage.setItem("customColors",JSON.stringify(g))},L=()=>{const g=document.documentElement;Object.keys(A).forEach(D=>{g.style.removeProperty(`--${D}`)}),N({}),localStorage.removeItem("customColors")},P=g=>{document.documentElement.classList.remove(`${p}-theme`),m.includes(g)?L():(o==null||o.emit("get_theme",{themeName:g}),o==null||o.on("themeRetrieved",D=>{const W=D.colors;G(W)})),document.documentElement.classList.add(`${g}-theme`),w(g),localStorage.setItem("theme",g)},U=g=>{document.documentElement.classList.remove(`${p}-theme`),document.documentElement.classList.add(`${g}-theme`),w(g),localStorage.setItem("theme",g)};return e.jsx(ct.Provider,{value:{theme:p,toggleTheme:U,toggleThemeToRemoveCustomColor:P,customColors:A,applyCustomColors:G,setTheme:w,allThemes:n,setAllThemes:a,addTheme:l},children:t})},dt=()=>{const t=r.useContext(ct);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},tr=()=>{const{allThemes:t,theme:o,toggleThemeToRemoveCustomColor:s}=dt();return e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"theme-select",className:"block custom-font-size font-medium text-[--textColor] mb-2",children:"Select Theme"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{id:"theme-select",value:o,onChange:n=>s(n.target.value),className:"block w-full bg-[--bgColor] border-[--borderColor] rounded-md py-2 pl-3 pr-10 text-[--textColor] focus:outline-none focus:ring-1 focus:ring-[--blueColor] focus:border-[--blueColor] sm:custom-font-size appearance-none hide-scrollbar max-h-[100px] overflow-auto",children:t.map(n=>e.jsx("option",{value:n,children:n.replace("-"," ")},n))}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-[--textColor]",children:e.jsx(wt,{size:16})})]})]})};function rr({socket:t,isConnected:o,sendMessage:s}){return dt(),r.useState(!1),r.useState(!1),r.useState(100),r.useState(1),r.useState(!1),r.useState("select"),r.useState(["#1e3a8a","#3b82f6","#93c5fd","#bfdbfe","#dbeafe"]),r.useState(""),r.useState(""),r.useEffect(()=>{if(!(!t||!o))return t.on("themeSaved",n=>{}),t.on("error",n=>{console.error(n.error)}),()=>{t.off("themeSaved"),t.off("error")}},[]),e.jsxs("div",{className:"overflow-y-auto w-3/4 p-4 max-h-[552px] hide-scrollbar",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-6",children:"Appearance"}),e.jsx(tr,{}),e.jsxs("div",{className:"bg-[--selectionBackgroundColor] p-4 rounded-lg mb-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("span",{children:"Current theme"})}),e.jsxs("div",{className:"mt-2 bg-[--bgColor] rounded p-2",children:[e.jsx("code",{className:"text-[--greenColor]",children:"ls"}),e.jsx("code",{className:"text-[--redColor]",children:" executable "}),e.jsx("code",{className:"text-[--blueColor]",children:"file"})]})]})]})}function sr(){return e.jsx("div",{className:"overflow-y-auto w-3/4 p-4 max-h-[552px] hide-scrollbar text-[--textColor]",children:e.jsx("p",{children:"You do not have any shared block yet."})})}const st=[{command:"for Auto completion",shortcut:["Arrow","->"]},{command:"Mode Switching",shortcut:["Ctrl","I"]},{command:"Activate Next Tab",shortcut:["Ctrl","Shift","T"]},{command:"Deactivate Current Tab",shortcut:["Ctrl","Esc"]},{command:"Open Settings",shortcut:["Ctrl",","]},{command:"Close Settings",shortcut:["Ctrl","."]},{command:"Close Codemate Essentials",shortcut:["Ctrl","Shift","R"]},{command:"Open New Split Plane",shortcut:["Ctrl","Shift","P"]},{command:"Close Current Plane",shortcut:["Ctrl","Shift","B"]},{command:"Open File Menu",shortcut:["Ctrl","Shift","O"]},{command:"Change to terminal",shortcut:["Ctrl","Shift","C"]},{command:"Change to AI",shortcut:["Ctrl","Shift","A"]},{command:"Attach message to context",shortcut:["Double-click"]}];function or(){r.useState("Keyboard shortcuts");const[t,o]=r.useState(""),[s,n]=r.useState(st[0].command),a=({command:i,shortcut:l,isActive:m})=>e.jsxs("div",{className:`flex justify-between items-center p-2 rounded cursor-pointer ${i===s?"bg-[--greenColorGradientStart] text-[--textColor]":m?"bg-[--darkGreenColor]":"bg-[--selectionBackgroundColor]"}`,onClick:()=>n(i),children:[e.jsx("span",{children:i}),e.jsx("div",{className:"flex space-x-1",children:l.map((d,p)=>e.jsx("span",{className:"bg-[--selectionBackgroundColor] px-1 rounded custom-font-size",children:d==="⌘"?e.jsx(jt,{}):d==="↑"?e.jsx(St,{}):d==="↓"?e.jsx(Nt,{}):d},p))})]});return e.jsxs("div",{className:"overflow-y-auto w-3/4 p-4 max-h-[440px] hide-scrollbar",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-6",children:"keyboard shortcuts"}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search",className:"w-full bg-gray-800 p-2 pl-8 rounded",value:t,onChange:i=>o(i.target.value)}),e.jsx(yt,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-[--grayColor]",size:20})]}),e.jsx("div",{className:"space-y-2",children:st.filter(i=>i.command.toLowerCase().includes(t.toLowerCase())).map((i,l)=>e.jsx(a,{...i},l))})]})}const nr=""+new URL("codemateLogoDark-B3pmvzl6.svg",import.meta.url).href,ar=""+new URL("codemateLogoLight-gpM7vgLZ.svg",import.meta.url).href;function lr(){const t=localStorage.getItem("theme");let o;return t==="codemate-ai-light"?o=nr:o=ar,e.jsxs("div",{className:"overflow-y-auto w-3/4 p-4 max-h-[552px] hide-scrollbar text-[--textColor]",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-6",children:"About"}),e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{children:[e.jsx("img",{src:o,alt:"codemate.ai-logo",className:"mb-3 h-20"}),e.jsx("p",{className:"text-[--textColor] custom-font-size flex justify-center mb-2",children:"v0.0.1"}),e.jsx("p",{className:"text-[--textColor] custom-font-size flex justify-center",children:"Copyright 2024 Codemate.ai"})]})})]})}function ir(){const[t,o]=r.useState(""),s=()=>{o("")};return e.jsxs("div",{className:"overflow-y-auto w-3/4 p-4 max-h-[552px] hide-scrollbar",children:[e.jsx("h2",{className:"custom-font-size font-bold mb-2",children:"Teams"}),e.jsx("h3",{className:"custom-font-size font-semibold mb-2",children:"Create a team"}),e.jsx("p",{className:"custom-font-size text-[--textColor] mb-4",children:"When you create a team, you can collaborate async or in real-time with shared notebooks (runbooks), workflows (like aliases), and terminal sessions."}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Team name",className:"flex-grow bg-[--grayColor] p-2 rounded",value:t,onChange:n=>o(n.target.value)}),e.jsx("button",{className:"bg-[--blueColor] text-[--textColor] px-4 py-2 rounded hover:bg-[--darkBlueColor] transition-colors",onClick:s,children:"Create"})]})]})}function cr(){const[t,o]=r.useState(""),[s,n]=r.useState("");return e.jsxs("div",{className:"overflow-y-auto w-3/4 p-4 max-h-[552px] hide-scrollbar",children:[e.jsx("p",{className:"custom-font-size text-[--textColor] mb-2",children:'Configure whether CodeMate.ai attempts to "CodeMate.aiify" the subshell for certain commands. CodeMate.ai supports bash, zsh, and fish subshells.'}),e.jsx("a",{href:"#",className:"text-[--blueColor] hover:underline mb-4 inline-block",children:"Learn more"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h3",{className:"custom-font-size font-semibold flex items-center mb-2",children:[e.jsx(Tt,{className:"mr-2 text-[--greenColor]"})," Added commands"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"command (supports regex)",className:"w-full bg-[--grayColor] p-2 pr-8 rounded",value:t,onChange:a=>o(a.target.value)}),e.jsx(et,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-[--textColor]"})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"custom-font-size font-semibold flex items-center mb-2",children:[e.jsx(kt,{className:"mr-2 text-[--redColor]"})," Blocklisted commands"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"command",className:"w-full bg-[--grayColor] p-2 pr-8 rounded",value:s,onChange:a=>n(a.target.value)}),e.jsx(et,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-[--textColor]"})]})]})]})}const dr=[{id:"gpt-4o-mini",provider:"OpenAI",providerId:"openai",name:"GPT-4o Mini",multiModal:!0},{id:"gpt-4o",provider:"OpenAI",providerId:"openai",name:"GPT-4o",multiModal:!0},{id:"gpt-4",provider:"OpenAI",providerId:"openai",name:"GPT-4",multiModal:!0},{id:"gpt-4-turbo",provider:"OpenAI",providerId:"openai",name:"GPT-4 Turbo",multiModal:!0},{id:"gpt-3.5-turbo",provider:"OpenAI",providerId:"openai",name:"GPT-3.5 Turbo",multiModal:!0},{id:"gpt-4-azure",provider:"OpenAI (Azure)",providerId:"openaiAzure",name:"azure",multiModal:!0},{id:"gemini/gemini-pro",provider:"Google Generative AI",providerId:"google",name:"Gemini Pro",multiModal:!0},{id:"gemini/gemini-1.5-flash",provider:"Google Generative AI",providerId:"google",name:"Gemini 1.5 Flash",multiModal:!0},{id:"gemini/gemini-1.0-pro",provider:"Google Generative AI",providerId:"google",name:"Gemini 1.0 pro",multiModal:!0},{id:"anthropic/claude-3-5-sonnet-20240620",provider:"Anthropic",providerId:"anthropic",name:"Claude 3.5 Sonnet",multiModal:!0},{id:"anthropic/claude-3-5-haiku-20241022",provider:"Anthropic",providerId:"anthropic",name:"Claude 3 haiku",multiModal:!0},{id:"anthropic/claude-3-opus-20240229",provider:"Anthropic",providerId:"anthropic",name:"Claude 3 Opus",multiModal:!0},{id:"claude-2.1",provider:"Anthropic",providerId:"anthropic",name:"Claude 2.1",multiModal:!0},{id:"claude-2",provider:"Anthropic",providerId:"anthropic",name:"Claude 2",multiModal:!0}],ur={models:dr};function mr({provider:t,name:o,params:s}){const[n,a]=r.useState({}),i=d=>{a(p=>({...p,[d]:!p[d]}))},l=async d=>{try{await navigator.clipboard.writeText(d)}catch(p){console.error("Failed to copy text: ",p)}},m=d=>{d.stopPropagation()};return e.jsxs("div",{className:"w-full bg-[--bgColor] border border-[--borderColor] rounded-lg p-4 mt-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"custom-font-size font-semibold text-[--textColor]",children:"Current Model Details"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h2",{className:"custom-font-size  text-[--textColor] opacity-70",children:"Provider"}),e.jsx("p",{className:"custom-font-size text-[--textColor] opacity-70",children:t})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h2",{className:"custom-font-size  text-[--textColor] opacity-70",children:"Model Name"}),e.jsx("p",{className:"custom-font-size text-[--textColor] opacity-70",children:o})]})]}),e.jsx("div",{className:"space-y-4",children:Object.entries(s).map(([d,p])=>e.jsxs("div",{children:[e.jsx("label",{className:"block custom-font-size font-medium text-[--textColor] opacity-70 mb-1",children:d}),e.jsxs("div",{className:"flex items-center bg-[--bgGradientEnd] border border-[--borderColor] rounded overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-x-auto whitespace-nowrap hide-scrollbar py-2 px-3",children:e.jsx("code",{className:"font-mono custom-font-size text-[--textColor]",children:n[d]?p:"•".repeat(p.length)})}),e.jsxs("div",{className:"flex items-center border-l border-[--borderColor] bg-[--bgGradientEnd] px-2",children:[e.jsx("button",{onClick:w=>{i(d),m(w)},className:"p-1 hover:bg-[--bgColor] rounded transition-colors","aria-label":n[d]?`Hide ${d}`:`Show ${d}`,children:n[d]?e.jsx(Et,{className:"w-4 h-4 text-[--textColor]"}):e.jsx(_t,{className:"w-4 h-4 text-[--textColor]"})}),e.jsx("button",{onClick:w=>{l(p),m(w)},className:"p-1 hover:bg-[--bgColor] rounded transition-colors ml-1","aria-label":`Copy ${d}`,children:e.jsx(Lt,{className:"w-4 h-4 text-[--textColor]"})})]})]})]},d))})]})}const fr={registerListener:()=>{},removeListener:()=>{},triggerListener:()=>{}},Ce=r.createContext(fr),Oe=t=>Array.from(t).join("+"),pr=({children:t})=>{const[o,s]=r.useState(new Map),n=r.useCallback((l,m)=>{const d=Oe(l);s(p=>new Map(p).set(d,m))},[]),a=r.useCallback(l=>{o.delete(Oe(l))},[]),i=r.useCallback(l=>{const m=o.get(Oe(l));m&&m()},[o]);return e.jsx(Ce.Provider,{value:{registerListener:n,removeListener:a,triggerListener:i},children:t})},Fe={openai:["apiKey"],openaiAzure:["deployment_name","apiKey","endpoint","api_version"],google:["apiKey"],anthropic:["apiKey"]};function hr({label:t,defaultChecked:o=!1,onChange:s,className:n="",socket:a,isConnected:i}){const[l,m]=r.useState(o);r.useEffect(()=>{if(a&&i)return a.emit("checkCodemateModelStatus"),a.on("codemateModelStatus",p=>{p&&p.selected!==void 0?m(p.selected):m(!1)}),()=>{a.off("codemateModelStatus")};console.log("Socket not connected, cannot emit event")},[a,i]),r.useEffect(()=>{const p=localStorage.getItem("selected");m(p==="true")},[]);const d=()=>{const p=!l;m(p),s==null||s(p),a&&i&&a.emit("updateCodemateModel",{selected:p}),localStorage.setItem("selected",JSON.stringify(p))};return e.jsxs("div",{className:`flex items-center justify-between ${n} mb-4`,children:[t&&e.jsx("span",{className:"text-sm text-[--primaryTextColor] mr-2",children:t}),e.jsxs("button",{role:"switch","aria-checked":l,onClick:d,className:`
          relative inline-flex h-6 w-11 items-center rounded-full
          transition-colors duration-200 ease-in-out focus:outline-none
          focus-visible:ring-2 focus-visible:ring-[--primaryTextColor] focus-visible:ring-opacity-75
          ${l?"bg-[--darkBlueColor]":"bg-[--lightGrayColor]"}
        `,children:[e.jsx("span",{className:"sr-only",children:t||"Toggle"}),e.jsx("span",{className:`
            inline-block h-4 w-4 transform rounded-full
            bg-[--primaryTextColor] transition duration-200 ease-in-out
            ${l?"translate-x-6":"translate-x-1"}
          `})]})]})}function xr({socket:t,isConnected:o}){const{registerListener:s,removeListener:n}=r.useContext(Ce),[a,i]=r.useState(""),[l,m]=r.useState(null),[d,p]=r.useState({}),[w,A]=r.useState(null),[N,G]=r.useState(ur.models),[L,P]=r.useState([]),[U,g]=r.useState(!1),[D,W]=r.useState(""),[O,$]=r.useState(!1),[V,x]=r.useState(null),[k,u]=r.useState(!1);r.useEffect(()=>{const S=localStorage.getItem("user");S&&A(JSON.parse(S));const z=Array.from(new Set(N.map(K=>K.provider)));if(P(z),t&&o){t.emit("get_current_model");const K=B=>{x(B||null)};return t.on("currentModelRetrieved",K),()=>{t.off("currentModelRetrieved",K)}}},[t,o,N]),r.useEffect(()=>{$(!!localStorage.getItem("session_token"))},[]),r.useEffect(()=>{const S=localStorage.getItem("selected");S&&u(S==="true")},[]);const h=r.useCallback(S=>{const z=S.target.value;i(z),m(null),p({})},[]),f=r.useCallback(S=>{var B;const z=S.target.value,K=N.find(Y=>Y.id===z);if(m(K||null),K){const Y=K.providerId||"",b={};(B=Fe[Y])==null||B.forEach(H=>{b[H]=""}),p(b),t&&o&&t.emit("get_model_details",{modelId:z})}else p({})},[t,o,N]);r.useEffect(()=>{if(t&&o&&l){const S=K=>{var B;if(K&&K.params)p(K.params);else{const Y=l.providerId||"",b={};(B=Fe[Y])==null||B.forEach(H=>{b[H]=""}),p(b)}},z=K=>{var b;const B=l.providerId||"",Y={};(b=Fe[B])==null||b.forEach(H=>{Y[H]=""}),p(Y)};return t.on("modelDetailsRetrieved",S),t.on("error",z),()=>{t.off("modelDetailsRetrieved",S),t.off("error",z)}}},[t,o,l]);const j=S=>{p(z=>({...z,[S.target.name]:S.target.value}))},M=S=>{if(S.preventDefault(),t&&o&&l){g(!0),W("");const z={model:l,params:d};t.emit("saveModelDetails",z)}};r.useEffect(()=>{if(t&&o){const S=K=>{g(!1),W(K.message);const B=setTimeout(()=>{W("")},3e3);return()=>clearTimeout(B)},z=K=>{g(!1),W("An error occurred while saving model details.");const B=setTimeout(()=>{W("")},3e3);return()=>clearTimeout(B)};return t.on("modelDetailsSaved",S),t.on("error",z),()=>{t.off("modelDetailsSaved",S),t.off("error",z)}}},[t,o]);const I=(w==null?void 0:w.planType)==="pro"?[...N.filter(S=>S.provider===a),{id:"codemate.ai-model",provider:"CodeMate.ai",providerId:"codemate",name:"CodeMate.ai Model",multiModal:!0}]:N.filter(S=>S.provider===a);r.useEffect(()=>{const S=new Set(["control","."]);return s(S,()=>{i(""),m(null),p({}),W("")}),()=>{n(S)}},[s,n,i,m,p,W]);const q=S=>{u(S)},J=()=>U?e.jsx("p",{children:"Loading current model..."}):V?k?e.jsx("div",{className:"w-full bg-[--bgColor] border border-[--borderColor] rounded-lg p-4 mt-4",children:e.jsx("div",{className:"space-y-4",children:e.jsx("p",{className:"text-xl text-center text-[--secondaryTextColor]",children:"Using CodeMate.ai for Advanced Code Assistance"})})}):e.jsx(mr,{provider:V.id.provider,name:V.id.name,params:V.params}):e.jsx("p",{children:"No current model selected."});return e.jsxs("div",{className:"overflow-y-auto w-3/4 p-4 max-h-[552px] hide-scrollbar",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-6",children:"LLM Models"}),O&&e.jsx(hr,{label:"Activate CodeMate.ai for Advanced Code Assistance",defaultChecked:!0,onChange:q,socket:t,isConnected:o}),e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"provider",className:"block custom-font-size font-medium text-[--textColor]",children:"Select Provider"}),e.jsx("div",{className:"relative",children:e.jsxs("select",{id:"provider",value:a,onChange:h,className:"block w-full bg-[--bgGradientEnd] border-[--borderColor] rounded-md py-2 pl-3 pr-10 text-[--textColor] focus:outline-none focus:ring-1 focus:ring-[--blueColor] focus:border-[--blueColor] sm:custom-font-size appearance-none hide-scrollbar max-h-[100px] overflow-auto",children:[e.jsx("option",{value:"",children:"Select a provider"}),L.map(S=>e.jsx("option",{value:S,children:S},S))]})})]}),a&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"model",className:"block custom-font-size font-medium text-[--textColor]",children:"Select Model"}),e.jsx("div",{className:"relative",children:e.jsxs("select",{id:"model",value:l?l.id:"",onChange:f,className:"block w-full bg-[--bgColor] border-[--borderColor] rounded-md py-2 pl-3 pr-10 text-[--textColor] focus:outline-none focus:ring-1 focus:ring-[--blueColor] focus:border-[--blueColor] sm:custom-font-size appearance-none hide-scrollbar max-h-[100px] overflow-auto",children:[e.jsx("option",{value:"",children:"Select a model"}),I.map(S=>e.jsx("option",{value:S.id,children:S.name},S.id))]})})]}),l&&Object.keys(d).length>0&&e.jsx("div",{className:"space-y-2",children:Object.entries(d).map(([S,z])=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:S,className:"block custom-font-size font-medium text-[--textColor]",children:S}),e.jsx("input",{type:"text",id:S,name:S,value:z,onChange:j,className:"block w-full bg-[--bgColor] border-[--borderColor] rounded-md py-2 pl-3 pr-10 text-[--textColor] focus:outline-none focus:ring-1 focus:ring-[--blueColor] focus:border-[--blueColor] sm:custom-font-size appearance-none hide-scrollbar max-h-[100px] overflow-auto"})]},S))}),e.jsx("button",{type:"submit",disabled:!l||Object.values(d).some(S=>!S)||U,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm custom-font-size font-medium  bg-[--darkBlueColorGradientStart] hover:bg-[--darkBlueColorGradientStart] bg-gradient-to-l from-[--darkBlueColorGradientStart] to-[--purpleColor] text-[--textColor] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[--darkBlueColorGradientStart] disabled:opacity-50",children:U?"Loading...":"Select"})]}),J(),D&&e.jsx("div",{className:"mt-4 text-green-500 text-center",children:D}),e.jsx("div",{className:"mt-4 custom-font-size text-[--grayColor] text-center",children:"Press Ctrl + . to close the model selection"})]})}const gr=({products:t})=>{const o=s=>{window.electron.openExternalLink(s).then(n=>{}).catch(n=>{console.error("Error opening URL:",n)})};return e.jsxs("div",{className:"overflow-y-auto w-3/4 p-4 max-h-[552px] hide-scrollbar text-[--textColor]",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-6",children:"Products"}),t.map((s,n)=>{var a;return e.jsxs("div",{className:"bg-[--bgColor] border border-[--borderColor] rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("img",{src:s.imageSrc,alt:s.title,className:"mr-2 h-6"}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"custom-font-size mt-1",children:s.title})})]}),e.jsx("button",{onClick:()=>o(s.actionLinks.install),className:"bg-[--darkBlueColorGradientStart] text-[--textColor] py-2 px-4 rounded-md mb-3 hover:bg-[--darkBlueColorGradientEnd] transition-colors custom-font-size",children:s.installText}),e.jsxs("div",{className:"custom-font-size text-[--textColor]",children:[!s.isWeb&&e.jsxs(e.Fragment,{children:[((a=s==null?void 0:s.actionLinks)==null?void 0:a.marketplace)&&e.jsxs("button",{onClick:()=>o(s.actionLinks.marketplace),className:"flex items-center hover:text-[--lightGrayColor] transition-colors mb-1 custom-font-size",children:[e.jsx("span",{children:"View in VS Code Marketplace"}),e.jsx(tt,{className:"ml-1 w-3 h-3"})]}),e.jsxs("button",{onClick:()=>o(s.actionLinks.viewDocumentation),className:"flex items-center hover:text-[--lightGrayColor] transition-colors custom-font-size",children:[e.jsx("span",{children:"View in Documentation"}),e.jsx(tt,{className:"ml-1 w-3 h-3"})]})]}),s.description&&e.jsx("span",{className:"custom-font-size text-[--textColor]",children:s.description})]})]},n)})]})},br=""+new URL("vsCode-D_D1Uwwt.png",import.meta.url).href,Cr=""+new URL("web-icon-DZBV1AAe.png",import.meta.url).href,vr=""+new URL("web-icon-dark-DYiImE2-.png",import.meta.url).href;function wr({socket:t,isConnected:o}){const[s,n]=r.useState({remaining:0,total:0,resetTime:""}),a=l=>new Date(l*1e3).toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"});r.useEffect(()=>{if(localStorage.getItem("session_token")&&t&&o)return t.emit("user_request_rate_limit"),t.on("rateLimitData",m=>{n({remaining:m.total-m.remaining,total:m.total,resetTime:a(m.reset)})}),()=>{t.off("rateLimitData")};console.log("No session_token found in localStorage. Socket call not made.")},[t,o]);const i=localStorage.getItem("session_token");return e.jsxs("div",{className:"overflow-y-auto w-3/4 p-4 max-h-[552px] hide-scrollbar text-[--textColor]",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-6",children:"AI"}),i?e.jsx("div",{className:"space-y-8",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-[--secondaryTextColor] text-sm",children:"Request Usage"}),e.jsxs("div",{className:"flex items-center justify-between flex-1",children:[e.jsxs("p",{className:"text-sm text-[--secondaryTextColor]",children:["This is the monthly limit of AI requests for your account."," ",e.jsx("button",{className:"text-[--darkBlueColor] hover:underline",onClick:()=>window.electron.openExternalLink("https://codemate.ai/#pricing"),children:"Upgrade"})," ","to get more requests."]}),e.jsxs("div",{className:"text-right flex-none w-1/4",children:[e.jsxs("p",{className:"text-sm font-medium",children:[s.remaining,"/",s.total]}),e.jsxs("p",{className:"text-xs text-[--secondaryTextColor]",children:["Resets ",new Date(s.resetTime).toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]})]})]})}):e.jsx("div",{className:"space-y-4",children:e.jsx("p",{className:"text-xl text-center text-[--secondaryTextColor]",children:"Please sign in to use CodeMate.ai and access AI features."})})]})}function yr({isModalOpen:t,setIsModalOpen:o,socket:s,isConnected:n,sendMessage:a}){const[i,l]=r.useState("account"),m=localStorage.getItem("theme");let d;m==="codemate-ai-light"?d=Cr:d=vr;const p=[{title:"Visual Studio Code",imageSrc:br,installText:"Install our VS Code Extension",actionLinks:{install:"vscode:extension/AyushSinghal.Code-Mate",marketplace:"https://marketplace.visualstudio.com/items?itemName=AyushSinghal.Code-Mate",viewDocumentation:"https://docs.codemate.ai/"},isWeb:!1},{title:"Web",imageSrc:d,installText:"Try CodeMate on the web",actionLinks:{install:"https://app.codemate.ai/app/dashboard",viewDocumentation:"https://docs.codemate.ai/"},isWeb:!1}],w=()=>{switch(i){case"account":return e.jsx(Qt,{socket:s,isConnected:n,sendMessage:a});case"appearance":return e.jsx(rr,{socket:s,isConnected:n,sendMessage:a});case"shared-blocks":return e.jsx(sr,{});case"keyboard-shortcuts":return e.jsx(or,{});case"about":return e.jsx(lr,{});case"team":return e.jsx(ir,{});case"subShells":return e.jsx(cr,{});case"products":return e.jsx(gr,{products:p});case"llm-Models":return e.jsx(xr,{socket:s,isConnected:n});case"ai":return e.jsx(wr,{socket:s,isConnected:n});default:return null}};return e.jsx("div",{className:`fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 ${t?"block":"hidden"} z-10`,children:e.jsxs("div",{className:"bg-opacity-50 bg-gradient-to-b from-[--bgGradientStart] to-[--bgGradientEnd] text-[--textColor] rounded-lg xl:w-2/4 w-[600px] shadow-xl h-[500px]",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-[--borderColor]",children:[e.jsx("h2",{className:"custom-font-size font-semibold",children:"Settings"}),e.jsx("button",{onClick:()=>o(!1),className:"text-[--textColor]",children:e.jsx(ke,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex h-[434px]",children:[e.jsx("nav",{className:"w-1/4  border-r border-[--borderColor] p-2",children:e.jsxs("ul",{className:"space-y-4",children:[e.jsx("li",{className:`w-full text-left p-2 rounded cursor-pointer ${i==="account"?"bg-opacity-50 bg-gradient-to-r from-[--darkBlueColorGradientStart] to-[--purpleColor] text-[--primaryTextColor]":"text-[--secondaryTextColor] hover:[--darkGrayColor]"}`,onClick:()=>l("account"),children:"Account"}),e.jsx("li",{className:`w-full text-left p-2 rounded cursor-pointer ${i==="appearance"?"bg-opacity-50 bg-gradient-to-r from-[--darkBlueColorGradientStart] to-[--purpleColor] text-[--primaryTextColor]":"text-[--secondaryTextColor] hover:[--darkGrayColor]"}`,onClick:()=>l("appearance"),children:"Appearance"}),e.jsx("li",{className:`w-full text-left p-2 rounded  cursor-pointer ${i==="llm-Models"?"bg-opacity-50 bg-gradient-to-r from-[--darkBlueColorGradientStart] to-[--purpleColor] text-[--primaryTextColor]":"text-[--secondaryTextColor] hover:[--darkGrayColor]"}`,onClick:()=>l("llm-Models"),children:"LLM Models"}),e.jsx("li",{className:`w-full text-left p-2 rounded cursor-pointer ${i==="keyboard-shortcuts"?"bg-opacity-50 bg-gradient-to-r from-[--darkBlueColorGradientStart] to-[--purpleColor] text-[--primaryTextColor]":"text-[--secondaryTextColor] hover:[--darkGrayColor]"}`,onClick:()=>l("keyboard-shortcuts"),children:"Keyboard shortcuts"}),e.jsx("li",{className:`w-full text-left p-2 rounded cursor-pointer ${i==="products"?"bg-opacity-50 bg-gradient-to-r from-[--darkBlueColorGradientStart] to-[--purpleColor] text-[--primaryTextColor]":"text-[--secondaryTextColor] hover:[--darkGrayColor]"}`,onClick:()=>l("products"),children:"Products"}),e.jsx("li",{className:`w-full text-left p-2 rounded cursor-pointer ${i==="ai"?"bg-opacity-50 bg-gradient-to-r from-[--darkBlueColorGradientStart] to-[--purpleColor] text-[--primaryTextColor]":"text-[--secondaryTextColor] hover:[--darkGrayColor]"}`,onClick:()=>l("ai"),children:"AI"}),e.jsx("li",{className:`w-full text-left p-2 rounded cursor-pointer ${i==="about"?"bg-opacity-50 bg-gradient-to-r from-[--darkBlueColorGradientStart] to-[--purpleColor] text-[--primaryTextColor]":"text-[--secondaryTextColor] hover:[--darkGrayColor]"}`,onClick:()=>l("about"),children:"About"})]})}),e.jsx(e.Fragment,{children:w()})]})]})})}const jr=({onTabChange:t,onAddTab:o,onTabRemove:s,tabs:n,activeTabId:a,setActiveTab:i,isSliderOpen:l,setIsSliderOpen:m,socket:d,isConnected:p,sendMessage:w,updateTabName:A})=>{const{registerListener:N,removeListener:G}=r.useContext(Ce),[L,P]=r.useState(!1),[U,g]=r.useState(null),D=y=>{t(y)},W=(y,R)=>{R.stopPropagation(),s(y)},[O,$]=r.useState([{title:"What's New?",items:[]},{title:"Getting Started",items:[{text:"Create your first block",description:"Run a command to see your command and output grouped.",completed:!0},{text:"Navigate blocks",description:"Click to select a block and navigate with arrow keys.",completed:!0},{text:"Take an action on block",description:"Right click on a block to copy/paste, share, more.",completed:!0},{text:"Open command palette",description:"Access all of CodeMate.ai via the keyboard.",completed:!1},{text:"Set your theme",description:"Make CodeMate.ai your own by choosing a theme.",completed:!1}]},{title:"Maximize CodeMate.ai",items:[{text:"Create your first block",description:"Run a command to see your command and output grouped.",completed:!0},{text:"Navigate blocks",description:"Click to select a block and navigate with arrow keys.",completed:!0},{text:"Take an action on block",description:"Right click on a block to copy/paste, share, more.",completed:!0},{text:"Open command palette",description:"Access all of CodeMate.ai via the keyboard.",completed:!1},{text:"Set your theme",description:"Make CodeMate.ai your own by choosing a theme.",completed:!1}]},{title:"Advanced Setup",items:[{text:"Create your first block",description:"Run a command to see your command and output grouped.",completed:!0},{text:"Navigate blocks",description:"Click to select a block and navigate with arrow keys.",completed:!0},{text:"Take an action on block",description:"Right click on a block to copy/paste, share, more.",completed:!0},{text:"Open command palette",description:"Access all of CodeMate.ai via the keyboard.",completed:!1},{text:"Set your theme",description:"Make CodeMate.ai your own by choosing a theme.",completed:!1}]}]),[V,x]=r.useState({"What's New?":!0,"Getting Started":!0,"Maximize CodeMate.ai":!1,"Advanced Setup":!1}),k=y=>{x(R=>({...R,[y]:!R[y]}))},u=(y,R)=>{$(Z=>{const ne=[...Z];return ne[y].items[R].completed=!ne[y].items[R].completed,ne})},[h,f]=r.useState(!1),[j,M]=r.useState(null),[I,q]=r.useState("");r.useEffect(()=>{const y=new Set(["f2"]);return N(y,()=>{if(a){M(a);const Z=n.find(ne=>ne.id===a);Z&&q(Z.name),f(!0)}}),()=>{G(y)}},[a,n,N,G]);const J=y=>{M(y);const R=n.find(Z=>Z.id===y);R&&q(R.name),f(!0)},S=y=>{q(y.target.value)},z=()=>{j&&A(j,I),f(!1),M(null)},K=y=>{y.key==="Enter"&&z()},[B,Y]=r.useState({show:!1,text:"",x:0,y:0}),b=(y,R)=>{Y({show:!0,text:y,x:R.clientX,y:R.clientY})},H=()=>{Y({...B,show:!1})};return r.useEffect(()=>{const y=R=>{switch(R.key){case"D":R.ctrlKey&&(R.preventDefault(),s(a));break;case",":R.ctrlKey&&(R.preventDefault(),P(!0));break;case".":R.ctrlKey&&(R.preventDefault(),P(!1));break;case"R":R.ctrlKey&&R.shiftKey&&(R.preventDefault(),m(!1));break;case"T":R.ctrlKey&&R.shiftKey&&(R.preventDefault(),o());break;case"Escape":R.ctrlKey&&(R.preventDefault(),s(a))}};return window.addEventListener("keydown",y),()=>{window.removeEventListener("keydown",y)}},[a,s,o,P,m]),e.jsxs("div",{className:"flex  items-center bg-[--bgColor] shadow-lg shadow-[--shadowColor]/50 w-full z-10 relative h-8",children:[e.jsxs("div",{className:"flex items-center space-x-1 overflow-x-auto mr-16 hide-scrollbar ",children:[n.map(y=>e.jsxs("div",{className:`flex text-center text-[--textColor] hover:bg-[--darkGrayColor] transition-colors cursor-pointer h-9 items-center bg-opacity-50 bg-gradient-to-b from-[--bgGradientStart] to-[--bgGradientEnd] px-3 py-1 w-40 isolate  bg-[--grayColor] shadow-lg ring-1 ring-[--shadowColor] ${y.id===a?"relative bg-[--selectionBackgroundColor] font-medium border-b-2 border-gradient hide-scrollbar ":""}`,onClick:()=>D(y.id),onDoubleClick:()=>J(y.id),onMouseEnter:()=>g(y.id),onMouseLeave:()=>g(null),children:[h&&j===y.id?e.jsx("input",{type:"text",value:I,onChange:S,onBlur:z,onKeyDown:K,className:"custom-font-size text-[--textColor] bg-transparent  border-[--textColor] focus:outline-none hide-scrollbar w-full",autoFocus:!0}):e.jsx("span",{className:"custom-font-size text-[--primaryTextColor]",children:y.name}),U===y.id&&e.jsx(ke,{className:"ml-auto h-4 w-4 text-[--primaryTextColor] cursor-pointer",style:{transform:"scale(0.8)",filter:"contrast(0.5)"},onClick:R=>W(y.id,R)})]},y.id)),e.jsx("button",{className:"inline-block text-center px-4 py-2 cursor-pointer text-[--textColor] hover:bg-[--selectionBackgroundColor] transition-colors",onClick:o,onMouseEnter:y=>b("New tab (Ctrl+Shift+T)",y),onMouseLeave:H,children:"+"})]}),e.jsxs("div",{className:`fixed inset-y-0 right-0 w-80 bg-[--bgColor] shadow-lg transition-transform transform duration-300 ${l?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-[--borderColor] text-[--textColor]",children:[e.jsx("h2",{className:"custom-font-size font-semibold",children:"CodeMate.AI Essentials"}),e.jsx("button",{onClick:()=>m(!1),children:e.jsx(ke,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"bg-[--bgColor] text-[--textColor] w-full font-sans h-full overflow-y-auto hide-scrollbar",children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{className:"w-full bg-[--bgColor] text-[--blueColor] border border-[--darkBlueColor] rounded py-2 px-4 flex items-center justify-center mb-4",children:[e.jsx(Mt,{className:"w-4 h-4 mr-2"}),"Invite a friend to CodeMate.ai"]}),e.jsx("div",{className:"text-right custom-font-size text-[--secondaryTextColor] mb-4 cursor-pointer",children:"Mark all as read"})]}),e.jsx("div",{className:"flex-grow px-4",children:O.map((y,R)=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 cursor-pointer",onClick:()=>k(y.title),children:[e.jsxs("div",{className:"flex items-center",children:[V[y.title]?e.jsx(At,{className:"w-4 h-4 mr-1"}):e.jsx(Pt,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"custom-font-size font-medium",children:y.title})]}),y.title==="What's New?"&&e.jsx("span",{className:"custom-font-size text-[--blueColor]",children:"Read all changelogs"}),y.items.length>0&&y.title!=="What's New?"&&e.jsxs("span",{className:"custom-font-size text-[--textColor]",children:[y.items.filter(Z=>Z.completed).length,"/",y.items.length]})]}),V[y.title]&&e.jsx("div",{className:"ml-5 space-y-3",children:y.items.map((Z,ne)=>e.jsxs("div",{className:"flex items-start",children:[y.title!=="What's New?"?e.jsx("div",{className:`w-3 h-3 rounded-full mt-1 mr-2 cursor-pointer ${Z.completed?"bg-[--blueColor]":"border-2 border-[--borderColor]"}`,onClick:()=>u(R,ne)}):null,e.jsxs("div",{children:[e.jsx("div",{className:"custom-font-size",children:Z.text}),e.jsx("div",{className:"custom-font-size text-[--textColor]",children:Z.description})]})]},Z.text))})]},y.title))}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"custom-font-size text-[--textColor] mb-4",children:"v0.0.1"}),e.jsxs("div",{className:"flex justify-between custom-font-size text-[--textColor]",children:[e.jsxs("div",{className:"flex items-center cursor-pointer",children:[e.jsx(zt,{className:"w-4 h-4 mr-1"}),"Docs"]}),e.jsxs("div",{className:"flex items-center cursor-pointer",children:[e.jsx(Dt,{className:"w-4 h-4 mr-1"}),"Discord"]}),e.jsxs("div",{className:"flex items-center cursor-pointer",children:[e.jsx(It,{className:"w-4 h-4 mr-1"}),"Feedback"]})]})]})]})]}),e.jsx("div",{className:"flex items-center space-x-4 absolute right-0 h-8 mr-4",children:e.jsx(Rt,{onClick:()=>P(!0),style:{color:"var(--textColor)"},size:16,className:"cursor-pointer",onMouseEnter:y=>b("Settings (Ctrl+,)",y),onMouseLeave:H})}),B.show&&e.jsx("div",{style:{position:"fixed",top:B.y+10,left:B.x-50,backgroundColor:"#161b22",color:"white",padding:"5px",borderRadius:"3px",zIndex:1e3,fontSize:"12px"},children:B.text}),L&&e.jsx(yr,{isModalOpen:L,setIsModalOpen:P,socket:d,isConnected:p,sendMessage:w})]})};function We(){r.useState(0),r.useState(0);const t=(x,k,u,h,f)=>({id:`${x}-${k}-${u}-${h}`,type:k,content:[],splitLevel:u,contentType:k,depth:h,direction:f}),o=(x="terminal",k)=>{const u=Ut(),h=t(u,x,0,0,"horizontal");return k&&(h.filePath=k),{id:u,name:"~",children:[h],splitLevel:0,isSudoPassword:!1}},[s,n]=r.useState(()=>{const x=sessionStorage.getItem("tabs");return x?JSON.parse(x):[o()]}),[a,i]=r.useState(()=>sessionStorage.getItem("activeTabId")||s[0].id);r.useEffect(()=>{sessionStorage.setItem("tabs",JSON.stringify(s)),sessionStorage.setItem("activeTabId",a)},[s,a]);const l=()=>{const x=o();n(k=>{const u=[...k,x];return sessionStorage.setItem("tabs",JSON.stringify(u)),u}),i(x.id)},m=(x,k="terminal")=>{const u=o(k,x);return n(h=>[...h,u]),i(u.id),u.id},d=x=>{n(k=>{const u=k.filter(f=>f.id!==x),h=x===a&&u.length>0?u[u.length-1].id:a;return i(h),u})},p=x=>{i(x)},w=r.useCallback((x,k,u,h="terminal")=>{let f="";return n(j=>{const M=j.map(I=>{if(I.id!==x)return I;const J=(S=>S.flatMap(z=>{if(z.id===k){const K=u==="horizontal"?z.splitLevel+1:z.splitLevel,B=u==="vertical"?z.depth+1:z.depth,Y=t(x,h,K,B,u);return f=Y.id,[{...z,splitLevel:K,depth:B,direction:u},Y]}return[z]}))(I.children);return{...I,children:J}});return sessionStorage.setItem("tabs",JSON.stringify(M)),M}),f},[]),A=(x,k)=>{n(u=>{const h=u.map(f=>{if(f.id!==x)return f;const j=f.children.filter(M=>M.id!==k);if(j.length===0){const M=t(x,"terminal",0,0,"horizontal");return{...f,children:[M]}}return{...f,children:j}});return sessionStorage.setItem("tabs",JSON.stringify(h)),h})},N=(x,k,u,h)=>{n(f=>{const j=f.map(M=>{if(M.id!==x)return M;const I=M.children.map(q=>{if(q.id===k){const J=`${x}-${u.contentType}-${q.splitLevel}-${q.depth}`;return{...q,id:J,contentType:u.contentType,type:u.contentType,filePath:h,content:[]}}return q});return{...M,children:I}});return sessionStorage.setItem("tabs",JSON.stringify(j)),j})},G=(x,k)=>{n(u=>{const h=u.map(f=>f.id===x?{...f,name:k}:f);return sessionStorage.setItem("tabs",JSON.stringify(h)),h})},L=(x,k,u)=>{n(h=>{const f=h.map(j=>{if(j.id!==x)return j;const M=j.children.map(I=>I.id===k&&(I.contentType==="terminal"||I.contentType==="ai")?{...I,content:[...I.content,u]}:I);return{...j,children:M}});return sessionStorage.setItem("tabs",JSON.stringify(f)),f})},P=r.useCallback((x,k,u)=>{n(h=>{const f=h.map(j=>{if(j.id!==x)return j;const M=j.children.map(I=>{if(I.id===k&&I.contentType==="preview"){const q=Array.isArray(I.preview)?[...I.preview,...u]:[...u];return{...I,preview:q}}return I});return{...j,children:M}});return sessionStorage.setItem("tabs",JSON.stringify(f)),f})},[]),U=(x,k)=>{n(u=>{const h=u.map(f=>{if(f.id!==x)return f;const j=f.children.map(M=>M.id===k&&(M.contentType==="terminal"||M.contentType==="ai")?{...M,content:[]}:M);return{...f,children:j}});return sessionStorage.setItem("tabs",JSON.stringify(h)),h})},g=r.useCallback((x,k,u,h)=>{let f="";return n(j=>{const M=j.map(I=>{if(I.id!==x)return I;const J=(S=>S.flatMap(z=>{if(z.id===k){const K=u==="horizontal"?z.splitLevel+1:z.splitLevel,B=u==="vertical"?z.depth+1:z.depth,Y={id:`${x}-preview-${K}-${B}`,type:"preview",content:[],preview:h,splitLevel:K,contentType:"preview",depth:B,direction:u};return f=Y.id,[{...z,splitLevel:K,depth:B,direction:u},Y]}return[z]}))(I.children);return{...I,children:J}});return sessionStorage.setItem("tabs",JSON.stringify(M)),M}),f},[]),D=(x,k)=>{n(u=>{const h=u.map(f=>f.id!==x?f:{...f,isSudoPassword:!0,sudoPassword:k});return sessionStorage.setItem("tabs",JSON.stringify(h)),h})},W=x=>{const k=s.find(u=>u.id===x);return k?k.isSudoPassword:!1},O=x=>{const k=s.find(u=>u.id===x);return k?k.sudoPassword:""},$=r.useCallback((x,k,u)=>{n(h=>{const f=h.map(j=>{if(j.id!==x)return j;const M=j.children.map(I=>{if(I.id===k){const J=((I==null?void 0:I.streamingContent)||"")+u;return{...I,streamingContent:J}}return I});return{...j,children:M}});return sessionStorage.setItem("tabs",JSON.stringify(f)),f})},[]),V=r.useCallback((x,k)=>{n(u=>{const h=u.map(f=>{if(f.id!==x)return f;const j=f.children.map(M=>M.id===k&&(M.contentType==="terminal"||M.contentType==="ai")?{...M,streamingContent:void 0}:M);return{...f,children:j}});return sessionStorage.setItem("tabs",JSON.stringify(h)),h})},[]);return{tabs:s,activeTabId:a,addTab:l,removeTab:d,handleTabChange:p,splitChild:w,closeChild:A,updateChildData:N,updateTabName:G,addTerminalData:L,addTabAndReturnId:m,clearTerminalData:U,addPreviewCode:P,splitChildAndAddPreview:g,setSudoPasswordTab:D,getIsSudoPassword:W,getSudoPassword:O,updateStreamingContent:$,clearStreamingContent:V}}const Sr=({children:t,...o})=>e.jsx("h1",{className:"custom-font-size font-bold mb-4 border-b-2 border-[--darkBlueColor] text-[--textColor] pb-2",...o,children:t}),Nr=({children:t,...o})=>e.jsx("h2",{className:" font-semibold mb-3 text-[--textColor] mt-6",...o,children:t}),Tr=({children:t,...o})=>e.jsx("h3",{className:" font-medium mb-2 text-[--textColor] mt-4",...o,children:t}),kr=({children:t,...o})=>e.jsx("p",{className:"mb-4 leading-relaxed text-[--textColor]",...o,children:t}),ot=({children:t,ordered:o})=>{const s=o?"ol":"ul";return e.jsx(s,{className:"mb-4 pl-5 text-[--textColor]",children:t})},Er=({children:t,...o})=>e.jsx("li",{className:"mb-2 text-[--textColor]",...o,children:t}),_r=({children:t,...o})=>e.jsx("blockquote",{className:"border-l-4 border-[--darkBlueColor] pl-4 italic my-4 text-[--darkGrayColor]",...o,children:t}),Lr=({href:t,children:o,...s})=>{const n=a=>{a.preventDefault(),window.electron&&window.electron.openExternalLink?window.electron.openExternalLink(t).then(()=>{console.log(`Link opened in external browser: ${t}`)}).catch(i=>{console.error("Failed to open external link:",i)}):window.open(t,"_blank")};return e.jsx("a",{href:t,className:"text-[--darkBlueColor] hover:underline",onClick:n,...s,children:o})},Mr=({node:t,inline:o,className:s,children:n,onCopyCode:a,onCreateCode:i,isStreaming:l})=>{const m=/language-(\w+)/.exec(s||""),[d,p]=r.useState(!1);r.useState(!1);const w=()=>{if(!l)return;const N=String(n).trim();navigator.clipboard.writeText(N).then(()=>{a(N),p(!0),setTimeout(()=>p(!1),2e3)})},A=l?"text-[--darkBlueColor] hover:text-[--blueColor] cursor-pointer":"text-[--darkGrayColor] cursor-not-allowed";return!o&&m?e.jsxs("div",{className:"relative hide-scrollbar",children:[e.jsx("button",{onClick:w,className:`absolute top-0 right-10 m-2 ${A}`,title:"Copy Code",disabled:!l,children:d?e.jsx(Se,{size:20}):e.jsx(_e,{size:20})}),e.jsx(at,{style:lt,language:m[1],PreTag:"div",className:"rounded-md hide-scrollbar",children:String(n).replace(/\n$/,"")})]}):e.jsx("code",{className:"bg-[--selectionBackgroundColor] text-[--greenColor] px-1 rounded",children:n})},Ar=({children:t,className:o,onCopyCommand:s,onExecuteCommand:n,isStreaming:a})=>{const[i,l]=r.useState(!1),[m,d]=r.useState(!1),p=()=>{if(!a)return;const N=String(t).trim();navigator.clipboard.writeText(N).then(()=>{s(N),l(!0),setTimeout(()=>l(!1),2e3)})},w=()=>{if(!a)return;const N=String(t).trim();n(N),d(!0),setTimeout(()=>d(!1),2e3)},A=a?"text-[--darkBlueColor] hover:text-[--blueColor] cursor-pointer":"text-[--darkGrayColor] cursor-not-allowed";return e.jsxs("div",{className:"relative mb-4 hide-scrollbar",children:[e.jsx("button",{onClick:p,className:`absolute top-0 right-10 m-2 ${A}`,title:"Copy Command",disabled:!a,children:i?e.jsx(Se,{size:20}):e.jsx(_e,{size:20})}),e.jsx("button",{onClick:w,className:`absolute top-0 right-2 m-2 ${A}`,title:"Execute Command",disabled:!a,children:m?e.jsx(Se,{size:20}):e.jsx($t,{size:20})}),e.jsx(at,{style:lt,language:"bash",PreTag:"div",className:"rounded-md hide-scrollbar",children:String(t).trim()})]})},Ee=({markdownContent:t,onCopyCommand:o,onExecuteCommand:s,onCopyCode:n,onCreateCode:a,isStreaming:i})=>e.jsx("div",{className:"w-full mx-auto p-2 shadow-lg rounded-lg overflow-x-auto hide-scrollbar",children:e.jsx(Vt,{components:{h1:Sr,h2:Nr,h3:Tr,p:kr,ul:({children:l})=>e.jsx(ot,{ordered:!1,children:l}),ol:({children:l})=>e.jsx(ot,{ordered:!0,children:l}),li:Er,blockquote:_r,a:Lr,code:l=>{var m,d;return(m=l.className)!=null&&m.includes("language-bash")||(d=l.className)!=null&&d.includes("language-sh")?e.jsx(Ar,{...l,onCopyCommand:o,onExecuteCommand:s,isStreaming:i}):e.jsx(Mr,{...l,onCopyCode:n,onCreateCode:a,isStreaming:i})}},children:t})}),Pr=()=>{const t=navigator.platform.toLowerCase(),o=navigator.userAgent.toLowerCase();return t.includes("win")?"Windows":t.includes("mac")?"MacOS":t.includes("linux")?"Linux":o.includes("android")?"Android":o.includes("iphone")||o.includes("ipad")?"iOS":"Unknown"},ut=t=>{const o=/```([\s\S]*?)```/g,s=/^([\w.-]+)?\s*$/,n=t.match(o);return n?n.map(a=>{var w,A;const i=a.split(`
`),m=((A=(w=i[0].replace("```","").trim().match(s))==null?void 0:w[1])==null?void 0:A.toLowerCase())||"plaintext",d=i.slice(1,-1).join(`
`).trim();return["jsx","react","tsx"].includes(m)||m==="javascript"&&d.includes("React")?{language:"react",code:d}:m==="module.css"||m.endsWith(".module.css")?{language:"css",code:d}:{language:m,code:d}}).filter(a=>a.code.trim()!==""&&!["bash","sh","plaintext"].includes(a.language)):(console.warn("No code blocks found in the response"),[])},Be=(t,o)=>{let s=[];switch(o.toLowerCase()){case"windows":s=zr(t);break;case"linux":case"macos":s=Dr(t);break;default:throw new Error("Unsupported platform")}return s},zr=t=>{const o=t.trim().split(`
`);return o.length<3?[]:o.slice(3).map(n=>{const a=n.split(/\s+/),i=a[0],l=a[1],m=a[2],d=/^\d+$/.test(a[3])?a[3]:"",p=d?a.slice(4):a.slice(3),w=i.startsWith("d")||a.includes("<DIR>");return{mode:i,name:p.join(" "),isDirectory:w,lastWriteTime:`${l} ${m}`,length:d}})},Dr=t=>{const o=t.trim().split(`
`);return o.length===0?[]:o.filter(n=>n&&!n.startsWith("total")).map(n=>{const a=n.split(/\s+/),i=a[0],l=`${a[5]} ${a[6]} ${a[7]}`,m=a[4],d=a.slice(8).join(" "),p=i.startsWith("d");return{mode:i,name:d,isDirectory:p,lastWriteTime:l,length:m}})},Ir=()=>e.jsx(Gt,{className:"animate-spin text-[--promptColorGradientEnd] ml-1 mb-1"}),Rr=Ke.memo(({socket:t,isConnected:o,setHtopSession:s})=>{const n=r.useRef(null),[a,i]=r.useState(!1),[l,m]=r.useState(null);return r.useEffect(()=>(i(!0),()=>{i(!1)}),[]),r.useEffect(()=>{if(!a||!n.current)return;const d=new qt.Terminal,p=new Yt.FitAddon;d.loadAddon(p),d.open(n.current),p.fit(),m(d);const w=()=>{var P;const{width:A,height:N}=((P=n.current)==null?void 0:P.getBoundingClientRect())||{width:0,height:0},G=Math.floor(N/20),L=Math.floor(A/10);t.emit("resize_terminal",{rows:G,cols:L})};return w(),window.addEventListener("resize",w),t.on("htop_output",A=>{d.write(A.data)}),d.onData(A=>{t.emit("htop_input",A)}),t.on("resize_terminal",A=>{d&&d.resize(A.cols,A.rows)}),d.onKey(A=>{A.key==="\x1B[21~"&&s(!1)}),()=>{t.off("htop_output"),t.off("resize_terminal"),d.dispose(),window.removeEventListener("resize",w)}},[t,a,s]),e.jsx("div",{ref:n,style:{height:"100%",width:"100%",overflow:"hidden"}})}),nt=new Jt,$r=300,Gr=({socket:t,isConnected:o,terminalId:s,tabId:n,content:a,addTerminalData:i,onFileSelect:l,handleCreateFile:m,clearTerminalData:d,onShowPreview:p})=>{const{setSudoPasswordTab:w,getIsSudoPassword:A,getSudoPassword:N}=We(),{registerListener:G,removeListener:L}=r.useContext(Ce),P=r.useRef(null),U=r.useRef(null),g=r.useRef(null),[D,W]=r.useState([]),[O,$]=r.useState(""),[V,x]=r.useState(!1),[k,u]=r.useState(-1),[h,f]=r.useState(""),[j,M]=r.useState([]),[I,q]=r.useState({}),[J,S]=r.useState("starting bash "),z=r.useRef(null),[K,B]=r.useState(!1),[Y,b]=r.useState(""),[H,y]=r.useState(""),[R,Z]=r.useState(!1),[ne,me]=r.useState(!1),[le,ie]=r.useState(""),[fe,ae]=r.useState(!1),[ve,xe]=r.useState(!1),[pe,we]=r.useState(!1),[C,F]=r.useState("");r.useState("");const[_,re]=r.useState(!1),[se,ce]=r.useState(!1),[de,Ne]=r.useState(""),ye=r.useRef(null),[he,ft]=r.useState([]),[Le,Me]=r.useState(!0),[pt,os]=r.useState([]),[Ae,ns]=r.useState(0),[Pe,He]=r.useState(!1),[Ue,Ve]=r.useState(!1),ze=r.useRef(null),ge=Pr();let ht="Enter filename:";const oe=r.useRef(null),De=r.useRef(null);r.useEffect(()=>{ye.current&&(ye.current.scrollTop=ye.current.scrollHeight)},[le]),r.useEffect(()=>{if(ze.current){const c=ze.current.children[Ae];c&&c.scrollIntoView({block:"nearest"})}},[Ae]),r.useEffect(()=>{!Ht||!o||t.emit("getCurrentDirectory",{terminal_id:s})},[n,t,o]),r.useEffect(()=>{const c=new Set(["control","i"]);return G(c,()=>{xt()}),()=>{L(c)}},[G,L]);const xt=()=>{re(c=>!c)},Je=async c=>{p(c)};r.useEffect(()=>{const c=new Set(["control","shift","alt"]);return G(c,()=>{var v;(v=P.current)==null||v.focus()}),()=>{L(c)}},[G,L]),r.useEffect(()=>{O.length===0&&f("")},[O,h]);const je=r.useCallback((c,E,v,T,ee,X=!1)=>{const Q=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),ue={id:Date.now(),text:c,type:E,timestamp:Q,current_cmd:v,commands:T,fileSystem:ee,isStreaming:X};M(te=>[ue,...te]);const be={inputCmd:v,output:String(c),status:E,timestamp:Q};i(n,s,be)},[n,s,i]),qe=r.useCallback(async()=>{t&&(t.emit("get_history"),t.once("history",c=>{if(c.error){console.error("Error fetching terminal history:",c.error);return}const{history_cmd:E}=c;W(E)}))},[t]),Ie=r.useCallback(c=>{navigator.clipboard.writeText(c).then(()=>{var E;$(c),(E=P.current)==null||E.focus(),q(v=>({...v,[c]:!0})),setTimeout(()=>{q(v=>({...v,[c]:!1}))},2e3)})},[]),Ye=r.useCallback(c=>{if(y(""),$(""),!t)return;const E=he.map(Q=>({role:Q.type==="nlp"?"assistant":"user",content:Q.current_cmd+`
`+Q.text})),v=he.length>0,T=j.slice(5).map(Q=>({role:Q.type==="nlp"?"assistant":"user",command:Q.current_cmd,content:Q.text})),ee=A(n),X=localStorage.getItem("session_token");t.emit("exec",{terminal_id:s,input:c,sudoPassword:ee?N(n):C,prompt:_,isContext:v,isTerminal:!0,lastTerminalMessages:T,context:v?E:void 0,user_session:X}),W(Q=>[...Q,c])},[t,s,he]),Xe=r.useCallback(c=>{var E;if(c.isDirectory){const v=`cd ${c.name}`;$(v),t&&o&&(t.emit("exec",{terminal_id:s,input:v,isTerminal:!0}),t.emit("getCurrentDirectory",{terminal_id:s}),$("")),(E=P.current)==null||E.focus()}else{let v;switch(ge.toLowerCase()){case"windows":v=`${J}\\${c.name}`;break;case"linux":case"macos":v=`${J}/${c.name}`;break;default:throw new Error("Unsupported platform")}l(v)}},[t,o,s,J,l]);r.useEffect(()=>{var c;(c=P.current)==null||c.focus()},[s]),r.useEffect(()=>{if(!t||!o)return;const c=T=>{T.terminal_id===s&&(me(!0),ie(""))},E=T=>{if(T.terminal_id===s){ae(!1);const ee=nt.toHtml(T.output);ie(X=>X+ee)}},v=T=>{T.terminal_id===s&&(me(!1),ie(""),t.emit("interactive_end_f10",{terminal_id:s}))};return t.on("interactive_start",c),t.on("interactive_output",E),t.on("interactive_end",v),()=>{t.off("interactive_start",c),t.off("interactive_output",E),t.off("interactive_end",v)}},[t,o,s,je,le]),r.useCallback(c=>{t&&o&&(t.emit("interactive_input",{terminal_id:s,input:c}),c===":wq"&&(me(!1),ie("")))},[t,o,s]),r.useEffect(()=>{U.current&&V&&(U.current.scrollTop=U.current.scrollHeight)},[D,V]),r.useEffect(()=>{g.current&&(g.current.scrollTop=0)},[j]);function gt(){const c=new KeyboardEvent("keydown",{key:",",code:"Comma",ctrlKey:!0,bubbles:!0,cancelable:!0});document.dispatchEvent(c)}r.useEffect(()=>{if(!t||!o)return;const c=E=>{E.terminal_id===s&&(A(n)||w(n,E.password))};return t.on("success_sudo_password",c),()=>{t.off("success_sudo_password",c)}},[n,s,A,w,t,o]),r.useEffect(()=>{if(!t||!o)return;const c=JSON.parse(localStorage.getItem("tabs")||"[]"),E=c.find(X=>X.id===n);if(E){const X=E.children.find(Q=>Q.id===s);X&&(X.curr_dir?S(X.curr_dir):t.emit("getCurrentDirectory",{terminal_id:s}))}const v=X=>{if(X.terminal_id===s){if(E){const Q=E.children.map(te=>te.id===s?{...te,curr_dir:X.directory}:te),ue={...E,children:Q},be=c.map(te=>te.id===n?ue:te);localStorage.setItem("tabs",JSON.stringify(be))}S(X.directory)}},T=X=>{X.terminal_id===s&&(gt(),oe.current&&clearTimeout(oe.current),ae(!1),xe(!1))},ee=()=>{t.emit("getCurrentDirectory",{terminal_id:s})};return t.on("currentDirectory",v),t.on("session_started",ee),t.on("require_signup_and_model_selection",T),t.emit("create_session",{terminal_id:s}),()=>{t.off("currentDirectory",v),t.off("session_started",ee)}},[t,o]),r.useEffect(()=>{qe()},[qe]),r.useEffect(()=>{M(a.map((c,E)=>({id:E,text:c.output,type:c.status,timestamp:c.timestamp,current_cmd:c.inputCmd,fileSystem:c.inputCmd.startsWith("dir")||c.inputCmd==="ls"||c.inputCmd==="ls -l"?Be(c.output,ge):void 0,isStreaming:!1})))},[a]);const Re=r.useCallback(c=>{const E=c.target.value;$(E),u(-1),x(!1),E.length===0&&f(""),z.current&&clearTimeout(z.current),z.current=setTimeout(()=>{t==null||t.emit("input",{input:E,terminal_id:s})},$r)},[t,s]),$e=r.useCallback(()=>{if(U.current&&k!==-1){const c=U.current.children[D.length-1-k];c&&(U.current.scrollTop=c.offsetTop-U.current.clientHeight/2+c.clientHeight/2)}},[k,D.length]),Ze=c=>{var E;b(c),B(!0),$(""),(E=P.current)==null||E.focus()},bt=r.useCallback(()=>{O.startsWith("cd ")&&!Le&&Me(!0)},[O,Le]);r.useEffect(()=>{if(!(!t||!o))return t.on("request_password",c=>{c.terminal_id==s&&(we(!0),ce(!1),oe.current&&clearTimeout(oe.current))}),t.on("request_confirmation",c=>{c.terminal_id==s&&(He(!0),ce(!1),oe.current&&clearTimeout(oe.current))}),()=>{t.off("request_password"),t.off("request_confirmation")}},[t,o]);const Ge=r.useCallback(c=>{var E;if(c.key==="Tab"){c.preventDefault(),bt();return}if(c.key==="Escape"){c.preventDefault(),Me(!1),x(!1);return}if(K&&t){if(c.key==="Enter"){c.preventDefault();const v=O.trim();v&&(m(Y,v,J),$(""),B(!1),t.emit("getCurrentDirectory",{terminal_id:s}))}return}switch(c.key){case"Enter":if(t&&o&&O.trim()){const v=O.trim(),T=v,ee=he.map(te=>({role:te.type==="nlp"?"assistant":"user",command:te.current_cmd,content:te.text})),X=j.slice(-5).map(te=>({role:te.type==="nlp"?"assistant":"user",command:te.current_cmd,content:te.text})),Q=A(n),ue=he.length>0,be=localStorage.getItem("session_token");if(T==="clear"&&!_&&(ge==="Linux"||ge==="MacOS")){d(n,s),$(""),f("");return}else if(T==="cls"&&!_&&ge==="Windows"){d(n,s),$(""),f("");return}if(pe){we(!1),t.emit("password_response",{terminal_id:s,password:T}),ce(!0),ae(!1),oe.current&&clearTimeout(oe.current),x(!1),$(""),u(-1),f("");return}if(Pe){He(!1),t.emit("confirmation_response",{terminal_id:s,response:T.trim().toLowerCase()}),ae(!1),oe.current&&clearTimeout(oe.current),x(!1),$(""),u(-1),f("");return}if(T=="htop"||T=="top"){t.emit("exec",{terminal_id:s,input:T,isTerminal:!0}),Ve(!0),x(!1),W(te=>[...te,O]),$(""),u(-1),f("");return}else v.startsWith("sudo ")&&Q&&ce(!0),oe.current=setTimeout(()=>{ae(!0)},2e3),De.current=setTimeout(()=>{ae(!1)},24e4),t.emit("exec",{terminal_id:s,input:T,sudoPassword:Q?N(n):C,prompt:_,isContext:ue,isTerminal:!0,lastTerminalMessages:X,context:ue?ee:void 0,user_session:be});(_||T.includes("sudo"))&&(xe(!0),ae(!1),oe.current&&clearTimeout(oe.current)),t.emit("getCurrentDirectory",{terminal_id:s}),x(!1),W(te=>[...te,O]),$(""),u(-1),f("")}break;case"ArrowUp":c.preventDefault(),D.length>0?V?u(v=>{const T=Math.max(v-1,0);return $(D[T]||""),$e(),T}):(x(!0),u(D.length-1),$(D[D.length-1]||"")):x(!0);break;case"ArrowDown":if(c.preventDefault(),D.length>0){if(V)if(k<D.length-1){const v=k+1;$(D[v]||""),u(v),$e()}else u(-1),$(""),x(!1)}else x(!1);break;case"ArrowRight":c.preventDefault(),h&&($(h),f(""),(E=P.current)==null||E.focus());break}},[t,o,O,s,D,V,k,h,$e,m,Y]);r.useEffect(()=>{if(!t||!o)return;const c=T=>{if(T.terminal_id===s){oe.current&&clearTimeout(oe.current),De.current&&clearTimeout(De.current),ae(!1),ce(!1),xe(!1);const ee=T.current_cmd.startsWith("dir")||T.current_cmd==="ls"||T.current_cmd==="ls -l"?Be(T.output,ge):void 0,X=nt.toHtml(T.output);je(X,T.status,T.current_cmd,T.commands,ee)}},E=T=>{T.terminal_id===s&&(typeof T.suggestions=="string"?f(T.suggestions):Array.isArray(T.suggestions)?f(T.suggestions.join(", ")):(console.error("Unexpected data format:",T),f("")))},v=T=>{if(T.terminal_id===s){oe.current&&clearTimeout(oe.current),ae(!1),xe(!1);let ee=T.output.trim();const X=/^```([a-zA-Z]*)\n([\s\S]*)\n```$/,Q=ee.match(X);Q&&(ee=Q[2].trim());const ue=ee.split(`
`).filter(be=>be.trim()!=="");ue.length>0?$(ue[0]):$(ee),re(!1)}};return t.on("command_output",c),t.on("suggestions",E),t.on("send_terminal_command",v),()=>{t.off("command_output",c),t.off("suggestions",E)}},[t,o,s,je]),r.useEffect(()=>{if(!t||!o)return;const c=v=>{v.terminal_id===s&&(Z(!0),xe(!1),ae(!1),y(T=>T+v.chunk),Ne(v.command))},E=v=>{if(v.terminal_id===s){Ne(""),ae(!1);const T=v.current_cmd.startsWith("dir")||v.current_cmd==="ls"||v.current_cmd==="ls -l"?Be(H,ge):void 0;je(v.output,v.status,v.current_cmd,v.commands,T);const ee=ut(H);ee.length>0&&Je(ee),y(""),Z(!1)}};return t.on("streaming_chunk",c),t.on("streaming_end",E),()=>{t.off("streaming_chunk",c),t.off("streaming_end",E)}},[t,o,s,H,je,Je]);const Ct=r.useCallback(c=>{ft(E=>E.some(T=>T.id===c.id)?E.filter(T=>T.id!==c.id):[...E,c])},[]),Qe=()=>{};return e.jsxs(e.Fragment,{children:[Ue&&t&&o&&e.jsx(Rr,{socket:t,isConnected:o,setHtopSession:Ve}),e.jsxs("div",{className:"custom-flex-grow-for-message-container flex pb-10 w-full h-full hide-scrollbar",children:[ve&&_&&e.jsx("div",{className:"absolute bottom-11 left-4 right-0 bg-[--bgColor] p-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Te,{className:"animate-spin mr-2"}),e.jsx("span",{children:"AI is thinking..."})]})}),se&&e.jsx("div",{className:"absolute bottom-11 left-4 right-0 bg-[--bgColor] p-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Te,{className:"animate-spin mr-2"}),e.jsx("span",{children:"Installing packages"})]})}),fe&&e.jsx("div",{className:"absolute bottom-11 left-4 right-0 bg-[--bgColor] p-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Te,{className:"animate-spin mr-2"}),e.jsx("span",{children:"Executing command"})]})}),e.jsxs("div",{ref:g,className:"overflow-auto flex flex-col-reverse hide-scrollbar w-full",children:[R&&e.jsxs("div",{className:"p-4 bg-opacity-50 bg-gradient-to-l from-[--bgGradientStart] to-[--scrollbarThumbColor] text-[--primaryTextColor] border-l-4 border-l-[--borderColor]",children:[e.jsx("span",{className:"custom-font-size pt-2",children:de}),e.jsx(Ee,{markdownContent:H,onCopyCommand:Ie,onExecuteCommand:Ye,onCopyCode:Qe,onCreateCode:Ze,isStreaming:!1})]}),j.slice().reverse().map((c,E)=>e.jsxs("div",{className:`
        p-4 
        ${he.some(v=>v.id===c.id)?"border-[1px] border-[--yellowColor]":"border-t-[1px] border-opacity-50 border-t-[--outputBorderColor] "}
        ${c.type==="error"?"bg-opacity-50 bg-gradient-to-l from-[--bgGradientStart] to-[--redColorGradientStart] text-[--primaryTextColor] border-l-4 border-l-[--darkRedColor]":c.type==="success"?"bg-opacity-10 text-[--primaryTextColor] border-l-4 border-l-[--darkGreenColor]":"bg-opacity-50 bg-gradient-to-l from-[--bgGradientStart] to-[--scrollbarThumbColor] text-[--primaryTextColor] border-l-4 border-l-[--borderColor]"}
                  ${E===0&&ve?"mb-12":""}
                  ${E===0&&se?"mb-12":""}
                  ${E===0&&fe?"mb-12":""}
      `,onDoubleClick:()=>{_&&Ct(c)},children:[e.jsx("span",{className:"custom-font-size pt-2",children:c.current_cmd}),c.fileSystem?c.current_cmd==="ls -l"?e.jsx("div",{className:"font-mono custom-font-size p-4 rounded-lg overflow-x-auto whitespace-nowrap hide-scrollbar",children:e.jsx("table",{className:"w-full",children:e.jsx("tbody",{children:c.fileSystem.map((v,T)=>e.jsxs("tr",{className:"grid grid-cols-5",children:[e.jsx("td",{className:"pr-4 col-span-1",children:v.mode}),e.jsx("td",{className:"pr-4 col-span-2",children:v.lastWriteTime}),e.jsx("td",{className:"pr-4 col-span-2 cursor-pointer hover:text-[--textColor]",onClick:()=>Xe(v),children:v.name})]},T))})})}):e.jsx("div",{className:"font-mono custom-font-size rounded-lg overflow-x-auto hide-scrollbar",children:e.jsx("div",{className:"flex flex-wrap",children:c.fileSystem.map((v,T)=>e.jsx("div",{className:"p-2 cursor-pointer hover:text-[--textColor]",onClick:()=>Xe(v),children:v.name},T))})}):c.type==="nlp"?e.jsx(Ee,{markdownContent:String(c.text),onCopyCommand:Ie,onExecuteCommand:Ye,onCopyCode:Qe,onCreateCode:Ze,isStreaming:!0}):e.jsx("pre",{className:"whitespace-pre-wrap hide-scrollbar overflow-x-auto p-2",dangerouslySetInnerHTML:{__html:c.text}}),c.commands&&e.jsx("div",{className:"mt-2 space-y-2",children:c.commands.map((v,T)=>e.jsxs("div",{className:"flex items-center bg-[--darkGrayColor] p-2 rounded",children:[e.jsx("code",{className:"flex-grow text-[--textColor]",children:v}),e.jsx("button",{onClick:()=>Ie(v),className:"ml-2 text-[--lightGrayColor] hover:text-[--textColor] focus:outline-none",children:I[v]?e.jsx(Se,{className:"text-[--greenColor]"}):e.jsx(_e,{})})]},T))})]},c.id))]})]}),e.jsxs("div",{className:`absolute z-10 bottom-0 h-10 text-[--textColor] p-2 custom-font-size leading-relaxed font-mono w-full bg-[--bgColor] border-t border-[--borderColor] ${_?"border border-[--yellowColor]":""} ${Ue?"hidden":""}`,children:[e.jsx("div",{ref:U,className:`absolute left-0 right-0 bottom-10 overflow-y-auto hide-scrollbar bg-[--darkGrayColor]  flex flex-col-reverse z-100 max-h-[8.75rem] p-4 w-full ${V?"":"hidden"}`,children:D.length>0?D.slice().reverse().map((c,E)=>e.jsx("div",{className:`rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 mb-2 ${k===D.length-1-E?"bg-gradient-to-br from-[--blueColor] to-[--darkBlueColor] text-[--textColor]":""}`,children:e.jsx("div",{className:`p-1 ${k===D.length-1-E?"text-[--textColor]":"text-[--primaryTextColor]"}`,children:e.jsx("h3",{className:"custom-font-size font-normal",children:c})})},E)):e.jsx("div",{className:"bg-gradient-to-br from-[--scrollbarThumbColor] to-[--scrollbarTrackColor] rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 mb-2",children:e.jsx("div",{className:"p-1 text-[--textColor]",children:e.jsx("h3",{className:"custom-font-size font-normal",children:"No Record Found"})})})}),e.jsxs("div",{className:"flex items-center w-full overflow-hidden",children:[e.jsx("div",{className:"text-transparent bg-clip-text bg-gradient-to-r from-[--promptColorGradientStart] to-[--promptColorGradientEnd] ",children:pe?"Please enter your password:":Pe?"Do you want to continue? (y/n):":K?ht:J}),!pe&&!K&&J.startsWith("starting bash")&&e.jsx(Ir,{}),e.jsx("div",{className:"relative flex-1 ml-4 flex items-center text-[--textColor]",children:e.jsxs("div",{className:"relative w-full",children:[pe?e.jsx("input",{type:"password",value:O,onChange:Re,onKeyDown:Ge,ref:P,className:"w-full bg-transparent text-transparent border-0 outline-none custom-font-size caret-transparent",autoComplete:"off","aria-label":"Password input",placeholder:"Enter password"}):Pe?e.jsx("input",{type:"text",value:O,onKeyDown:Ge,onChange:Re,ref:P,className:"flex-1 bg-transparent text-[--textColor] border-0 outline-none custom-font-size leading-relaxed font-mono w-full ",placeholder:"Enter Your Choice"}):e.jsx("input",{type:"text",value:O,onKeyDown:Ge,onChange:Re,ref:P,className:"flex-1 bg-transparent text-[--textColor] border-0 outline-none custom-font-size leading-relaxed font-mono w-full ",placeholder:_?"Ask in natural language":"Use Ctrl + I to enter agenting mode"}),Le&&e.jsx("div",{ref:ze,className:"absolute left-0 right-0 mt-2 max-h-[200px] overflow-y-auto bg-zinc-800 border border-zinc-700 rounded-md",children:pt.map((c,E)=>e.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 cursor-pointer ${E===Ae?"bg-pink-500 text-[--textColor]":"hover:bg-zinc-700"}`,onClick:()=>{$(`cd ${c.name}`),Me(!1)},children:[e.jsx(Ot,{className:"shrink-0"}),e.jsx("span",{children:c.name}),e.jsx("span",{className:"ml-auto custom-font-size text-zinc-400",children:"Directory"})]},c.name))}),h&&e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pointer-events-none",children:!pe&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-[--textColor]",children:O}),e.jsx("span",{className:"text-[--commentColor]",children:h.slice(O.length)})]})})]})})]})]})]})},Or=t=>{var s;switch((s=t.split(".").pop())==null?void 0:s.toLowerCase()){case"js":return"javascript";case"ts":return"typescript";case"py":return"python";case"java":return"java";case"html":return"html";case"css":return"css";case"php":return"php";case"c":case"cpp":return"c_cpp";case"cs":return"csharp";case"rb":return"ruby";case"go":return"golang";case"swift":return"swift";case"json":return"json";case"sql":return"sql";case"sh":return"sh";case"md":return"markdown";case"xml":return"xml";case"yaml":case"yml":return"yaml";case"kt":return"kotlin";case"r":return"r";case"lua":return"lua";case"scala":return"scala";case"vb":return"vbscript";case"pas":return"pascal";case"ps1":return"powershell";default:return"text"}},Fr=r.forwardRef(({tabId:t,editorId:o},s)=>{const[n,a]=r.useState(""),[i,l]=r.useState("text"),[m,d]=r.useState("");return r.useEffect(()=>{const w=setTimeout(async()=>{const N=JSON.parse(sessionStorage.getItem("tabs")||"[]").find(L=>L.id===t);if(!N){console.warn(`No tab found with id: ${t}`);return}const G=N.children.find(L=>L.id===o);if(!G){console.warn(`No editor found with id: ${o}`);return}if(G.filePath){const L=G.filePath.trim();if(d(L),l(Or(L)),L)try{const P=await window.electron.readFile(L);a(P)}catch(P){console.error(`Error reading file at path: ${L}`),console.error("Error:",P),a(""),d(""),alert("File not found or could not be read. Please check the file path.")}else console.warn("No valid file path available to load content from.")}else console.warn("Editor does not have a filePath defined.")},500);return()=>{clearTimeout(w)}},[t,o]),r.useEffect(()=>{const w=setTimeout(async()=>{if(m&&n.trim()===""){console.warn("File is empty. No content to save.");return}if(m&&n.trim()!=="")try{await window.electron.saveFile(m,n)}catch(A){console.error("Error saving file:",A)}},2e3);return()=>clearTimeout(w)},[n,m]),e.jsx("div",{ref:s,className:"h-full w-full",children:e.jsx(Xt,{mode:i,theme:"twilight",value:n,onChange:a,name:"editor",editorProps:{$blockScrolling:!0},setOptions:{fontSize:14,showLineNumbers:!0,tabSize:4,wrap:!0,highlightActiveLine:!0,highlightGutterLine:!0,useWorker:!1},width:"100%",height:"100%"})})}),Br=300,Kr=({socket:t,isConnected:o,chatId:s,tabId:n,content:a,addTerminalData:i,handleCreateFile:l,clearTerminalData:m,onShowPreview:d})=>{const p=r.useRef(null),w=r.useRef(null),A=r.useRef(null),[N,G]=r.useState([]),[L,P]=r.useState(""),[U,g]=r.useState(!1),[D,W]=r.useState(-1),[O,$]=r.useState(""),[V,x]=r.useState([]),[k,u]=r.useState({}),h=r.useRef(null),[f,j]=r.useState(""),[M,I]=r.useState(!1),[q,J]=r.useState(!1),[S,z]=r.useState(""),[K,B]=r.useState(!1),[Y,b]=r.useState(""),{tabs:H,updateStreamingContent:y,clearStreamingContent:R}=We(),{registerListener:Z,removeListener:ne}=r.useContext(Ce),me=async C=>{d(C)};r.useEffect(()=>{const C=new Set(["control","shift","alt"]);return Z(C,()=>{var _;(_=p.current)==null||_.focus()}),()=>{ne(C)}},[Z,ne]);const le=r.useCallback((C,F,_,re,se,ce=!1)=>{const de=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),Ne={id:Date.now(),text:C,type:F,timestamp:de,current_cmd:_,commands:re,fileSystem:se,isStreaming:ce};x(he=>[...he,Ne]);const ye={inputCmd:_,output:String(C),status:F,timestamp:de};i(n,s,ye)},[n,s,i]),ie=r.useCallback(C=>{navigator.clipboard.writeText(C).then(()=>{var F;P(C),(F=p.current)==null||F.focus(),u(_=>({..._,[C]:!0})),setTimeout(()=>{u(_=>({..._,[C]:!1}))},2e3)})},[]),fe=r.useCallback(C=>{j(""),P("");const F=localStorage.getItem("session_token");if(!t)return;const _=V.map(se=>({role:se.type==="nlp"?"assistant":"user",content:se.current_cmd+`
`+se.text})),re=V.length>0;t.emit("exec",{terminal_id:s,input:C,prompt:!0,isContext:re,context:re?_:void 0,user_session:F}),G(se=>[...se,C])},[t,s,V]);r.useEffect(()=>{var C;(C=p.current)==null||C.focus()},[s]),r.useEffect(()=>{w.current&&U&&(w.current.scrollTop=w.current.scrollHeight)},[N,U]),r.useEffect(()=>{A.current&&(A.current.scrollTop=0)},[V]),r.useEffect(()=>{if(!t||!o)return;const C=_=>{},F=()=>{};return t.on("session_started",F),t.on("require_signup_and_model_selection",C),t.on("limit_exceed",C),t.emit("create_session",{terminal_id:s}),()=>{t.off("session_started",F)}},[t,o]),r.useEffect(()=>{x(a.map((C,F)=>({id:F,text:C.output,type:C.status,timestamp:C.timestamp,current_cmd:C.inputCmd,fileSystem:void 0,isStreaming:!1})))},[a]);const ae=r.useCallback(C=>{const F=C.target.value;P(F),W(-1),g(!1),F.length===0&&$(""),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{t==null||t.emit("input",{input:F,terminal_id:s})},Br)},[t,s]),ve=r.useCallback(()=>{if(w.current&&D!==-1){const C=w.current.children[N.length-1-D];C&&(w.current.scrollTop=C.offsetTop-w.current.clientHeight/2+C.clientHeight/2)}},[D,N.length]),xe=r.useCallback(C=>{var _;const F=localStorage.getItem("session_token");if(C.key==="Escape"){g(!1);return}if(K&&t){C.key==="Enter"&&(C.preventDefault(),L.trim()&&(P(""),B(!1)));return}switch(C.key){case"Enter":if(t&&o&&L.trim()){const re=L.trim(),se=V.map(de=>({role:de.type==="nlp"?"assistant":"user",command:de.current_cmd,content:de.text})),ce=V.length>0;t.emit("exec",{terminal_id:s,input:re,prompt:!0,isContext:ce,context:ce?se:void 0,user_session:F}),J(!0),g(!1),G(de=>[...de,L]),P(""),W(-1),$("")}break;case"ArrowUp":C.preventDefault(),N.length>0?U?W(re=>{const se=Math.max(re-1,0);return P(N[se]||""),ve(),se}):(g(!0),W(N.length-1),P(N[N.length-1]||"")):g(!0);break;case"ArrowDown":if(C.preventDefault(),N.length>0){if(U)if(D<N.length-1){const re=D+1;P(N[re]||""),W(re),ve()}else W(-1),P(""),g(!1)}else g(!1);break;case"ArrowRight":C.preventDefault(),O&&(P(O),$(""),(_=p.current)==null||_.focus());break}},[t,o,L,s,N,U,D,O,ve,l]);r.useEffect(()=>{L.length===0&&$("")},[L,O]),r.useEffect(()=>{if(!t||!o)return;const C=_=>{_.terminal_id===s&&(J(!1),le(_.output,_.status,_.current_cmd,_.commands,void 0))},F=_=>{_.terminal_id===s&&(typeof _.suggestions=="string"?$(_.suggestions):Array.isArray(_.suggestions)?$(_.suggestions.join(", ")):$(""))};return t.on("command_output",C),t.on("suggestions",F),()=>{t.off("command_output",C),t.off("suggestions",F)}},[t,o,s,le]),r.useEffect(()=>{if(!t||!o)return;const C=_=>{_.terminal_id===s&&(I(!0),J(!1),y(n,s,_.chunk),b(_.command))},F=_=>{if(_.terminal_id===s){J(!1),b(""),le(_.output,_.status,_.current_cmd,_.commands,void 0);const se=ut(_.output);se.length>0&&me(se),R(n,s),I(!1)}};return t.on("streaming_chunk",C),t.on("streaming_end",F),()=>{t.off("streaming_chunk",C),t.off("streaming_end",F)}},[t,o,s,f,le,me,y,R,d]),r.useEffect(()=>{if(H){const C=H.find(F=>F.id===n);if(C){const F=C.children.find(_=>_.id===s);if(F){const _=F.streamingContent;j(_)}}}},[H,n,s]);const pe=C=>{var F;z(C),B(!0),P(""),(F=p.current)==null||F.focus()},we=()=>{};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"custom-flex-grow-for-message-container flex pb-10 w-full h-full hide-scrollbar",children:[q&&e.jsx("div",{className:"absolute bottom-11 left-4 right-0 bg-[--bgColor] p-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Te,{className:"animate-spin mr-2"}),e.jsx("span",{children:"AI is thinking..."})]})}),e.jsxs("div",{ref:A,className:"overflow-auto flex flex-col-reverse hide-scrollbar w-full",children:[M&&e.jsxs("div",{className:"p-4 bg-opacity-50 bg-gradient-to-l from-[--bgGradientStart] to-[--scrollbarThumbColor] text-[--primaryTextColor] border-l-4 border-l-[--borderColor]",children:[e.jsx("span",{className:"custom-font-size pt-2",children:Y}),e.jsx(Ee,{markdownContent:f,onCopyCommand:ie,onExecuteCommand:fe,onCopyCode:we,onCreateCode:pe,isStreaming:!1})]}),V.slice().reverse().map((C,F)=>e.jsxs("div",{className:`
                                        p-4 
                                        border-t-[1px] 
                                        border-opacity-50
                                        border-t-[--outputBorderColor]
                                        ${C.type==="error"?"bg-opacity-50 bg-gradient-to-l from-[--bgGradientStart] to-[--redColorGradientStart] text-[--primaryTextColor] border-l-4 border-l-[--darkRedColor]":C.type==="success"?"bg-opacity-10 text-[--primaryTextColor] border-l-4 border-l-[--darkGreenColor]":"bg-opacity-50 bg-gradient-to-l from-[--bgGradientStart] to-[--scrollbarThumbColor] text-[--primaryTextColor] border-l-4 border-l-[--borderColor]"}
                                                  ${F===0&&q?"mb-12":""}
                                
                                      `,children:[e.jsx("span",{className:"custom-font-size pt-2",children:C.current_cmd}),C.type==="nlp"?e.jsx(Ee,{markdownContent:String(C.text),onCopyCommand:ie,onExecuteCommand:fe,onCopyCode:we,onCreateCode:pe,isStreaming:!0}):e.jsx("pre",{className:"whitespace-pre-wrap hide-scrollbar overflow-x-auto p-2 custom-font-size",dangerouslySetInnerHTML:{__html:C.text}}),C.commands&&e.jsx("div",{className:"mt-2 space-y-2",children:C.commands.map((_,re)=>e.jsxs("div",{className:"flex items-center bg-[--darkGrayColor] p-2 rounded",children:[e.jsx("code",{className:"flex-grow text-[--textColor]",children:_}),e.jsx("button",{onClick:()=>ie(_),className:"ml-2 text-[--lightGrayColor] hover:text-[--textColor] focus:outline-none",children:k[_]?e.jsx(Se,{className:"text-[--greenColor]"}):e.jsx(_e,{})})]},re))})]},C.id))]})]}),e.jsxs("div",{className:"absolute z-10 bottom-0 h-10 text-[--textColor] p-2 custom-font-size leading-relaxed font-mono w-full bg-[--bgColor] border-t border-[--borderColor]",children:[e.jsx("div",{ref:w,className:`absolute left-0 right-0 bottom-10 overflow-y-auto hide-scrollbar bg-[--darkGrayColor]  flex flex-col-reverse z-100 max-h-40 p-4 w-full ${U?"":"hidden"}`,children:N.length>0?N.slice().reverse().map((C,F)=>e.jsx("div",{className:`rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 mb-2 ${D===N.length-1-F?"bg-gradient-to-br from-[--blueColor] to-[--darkBlueColor] text-[--textColor]":""}`,children:e.jsx("div",{className:`p-1 ${D===N.length-1-F?"text-[--textColor]":"text-[--primaryTextColor]"}`,children:e.jsx("h3",{className:"custom-font-size font-normal",children:C})})},F)):e.jsx("div",{className:"bg-gradient-to-br from-[--scrollbarThumbColor] to-[--scrollbarTrackColor] rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 mb-2",children:e.jsx("div",{className:"p-1 text-[--textColor]",children:e.jsx("h3",{className:"custom-font-size font-normal",children:"No Record Found"})})})}),e.jsxs("div",{className:"flex items-center w-full overflow-hidden",children:[e.jsx("div",{className:"text-transparent bg-clip-text bg-gradient-to-r from-[--promptColorGradientStart] to-[--promptColorGradientEnd]"}),e.jsx("div",{className:"relative flex-1 ml-4 flex items-center text-[--textColor]",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",value:L,onKeyDown:xe,onChange:ae,ref:p,placeholder:"Ask In Natural Language",className:"flex-1 bg-transparent text-[--textColor] border-0 outline-none custom-font-size leading-relaxed font-mono w-full"}),O&&e.jsxs("div",{className:"absolute inset-y-0 left-0 flex items-center pointer-events-none",children:[e.jsx("span",{className:"text-[--textColor]",children:L}),e.jsx("span",{className:"text-[--commentColor]",children:O.slice(L.length)})]})]})})]})]})]})};function Wr(t){const o=/import\s+(?:(\w+)\s*,?\s*)?(?:{([^}]+)})?\s+from\s+['"]react['"];?/g,s=/import\s+['"]([^'"]+\.css)['"];?/g,n=/import\s+\w+\s+from\s+['"]react-dom['"];?/g,a=/ReactDOM\.render\s*$$.+$$;?/g,i=/import\s+(\w+)\s+from\s+['"]\.\/(components\/)?(\w+)['"];?/g;let l=t,m,d="";const p=new Set,w=new Map;for(;(m=o.exec(t))!==null;)m[1]&&(d=m[1].trim()),m[2]&&m[2].split(",").forEach(G=>p.add(G.trim()));for(;(m=i.exec(t))!==null;)w.set(m[3],m[1]);l=l.replace(o,""),l=l.replace(s,""),l=l.replace(n,""),l=l.replace(a,""),l=l.replace(i,"");let A="";return d?A+=`const ${d} = window.React;
`:A+=`const React = window.React;
`,p.size>0&&(A+=`const { ${Array.from(p).join(", ")} } = React;
`),{code:(A+l).replace(/export default (\w+);?\s*$/,"return $1;"),componentImports:w}}function Hr(t){let o="",s="",n="";const a=new Map;if(t.forEach(i=>{switch(i.language.toLowerCase()){case"html":o=i.code||"";break;case"css":s+=i.code+`
`;break;case"javascript":case"js":n+=i.code+`
`;break;case"jsx":case"react":const{code:l,componentImports:m}=Wr(i.code);a.set(i.filename||"App",{code:l,imports:m});break}}),a.size>0){let i="",l="";return a.forEach((m,d)=>{i+=`
        const ${d} = (() => {
          ${m.code}
        })();
      `,(d==="index"||d==="App")&&(l=d)}),l||(l=Array.from(a.keys())[0]),console.log("html css js",o,s,n),`
      <!DOCTYPE html>
      <html>
        <head>
          <meta charset="utf-8" />
          <script src="https://unpkg.com/react@17/umd/react.production.min.js"><\/script>
          <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"><\/script>
          <script src="https://unpkg.com/@babel/standalone/babel.min.js"><\/script>
          <style>${s}</style>   
        </head>
        <body>
          <div id="app"></div>
          <script type="text/babel">
            ${i}
            ReactDOM.render(React.createElement(${l}), document.getElementById('app'));
          <\/script>
        </body>
      </html>
    `}else return`
      <!DOCTYPE html>
      <html>
        <head>
          <meta charset="utf-8" />
          <style>${s}</style>
        </head>
        <body>
          ${o}
          <script nonce="RANDOM_NONCE">${n}<\/script>
        </body>
      </html>
    `}const Ur=({codeBlocks:t})=>{const o=r.useRef(null);return r.useEffect(()=>{if(o.current){const s=Hr(t);o.current.srcdoc=s}},[t]),e.jsx("div",{className:"w-full h-full bg-opacity-50 bg-gradient-to-b from-[--bgGradientStart] to-[--bgGradientEnd] hide-scrollbar",children:e.jsx("iframe",{ref:o,className:"w-full h-full border-none hide-scrollbar",sandbox:"allow-scripts",title:"Code Preview"})})},mt=r.createContext({activeSplitScreenId:null,setActiveSplitScreenId:()=>{}}),Vr=({children:t})=>{const[o,s]=r.useState(null);return e.jsx(mt.Provider,{value:{activeSplitScreenId:o,setActiveSplitScreenId:s},children:t})},Jr=()=>r.useContext(mt),qr=({child:t,onSplit:o,onClose:s,socket:n,isConnected:a,onChangeContent:i,tabId:l,addTerminalData:m,isRootLevel:d,onAddTab:p,clearTerminalData:w,onResize:A,width:N,isLastPane:G,onShowPreview:L})=>{const{setActiveSplitScreenId:P,activeSplitScreenId:U}=Jr(),{registerListener:g,removeListener:D}=r.useContext(Ce),W=()=>{P(t.id)},[O,$]=r.useState(null),[V,x]=r.useState(!1),[k,u]=r.useState(""),h=r.useRef(null),f=r.useRef(null),j=r.useCallback(b=>{b.preventDefault(),x(!0),document.body.style.cursor="col-resize"},[]);r.useEffect(()=>{const b=y=>{var fe;if(!V||!h.current||!f.current)return;const R=(fe=h.current.parentElement)==null?void 0:fe.getBoundingClientRect(),Z=h.current.getBoundingClientRect();if(!R)return;const ne=100,me=R.width-ne;let le=y.clientX-R.left;le=Math.max(ne,Math.min(me,le));const ie=le-Z.right+f.current.offsetWidth/2;requestAnimationFrame(()=>{A(t.id,ie)})},H=()=>{x(!1),document.body.style.cursor="default"};return V&&(document.addEventListener("mousemove",b),document.addEventListener("mouseup",H)),()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",H)}},[V,t.id,A]);const M=r.useCallback(b=>{b.preventDefault(),$({x:b.clientX,y:b.clientY})},[]),I=r.useCallback(()=>{$(null)},[]);r.useEffect(()=>{const b=()=>I();return document.addEventListener("click",b),()=>document.removeEventListener("click",b)},[I]);const q=b=>{u(b),p(b,"editor")},J=async()=>{const b=await window.electron.openFile();if(b.length>0){const H=b[0];i(t.id,"editor",H)}},S=async(b,H,y)=>{try{const R=await window.electron.createFile(H,b,y),Z=p(R,"editor")}catch(R){console.error("Failed to create file:",R)}},z=[{keys:new Set(["control","shift","o"]),action:J},{keys:new Set(["control","shift","c"]),action:b=>i(b,"terminal","")},{keys:new Set(["control","shift","a"]),action:b=>i(b,"ai","")},{keys:new Set(["control","shift","p"]),action:b=>o(b,"vertical")},{keys:new Set(["control","shift","b"]),action:b=>s(b)}];r.useEffect(()=>(z.forEach(({keys:b,action:H})=>{g(b,()=>H(t.id))}),()=>{z.forEach(({keys:b})=>{D(b)})}),[t.id,g,D]);const K=b=>{switch(b.contentType){case"terminal":return e.jsx(Gr,{socket:n,isConnected:a,terminalId:b.id,tabId:l,content:b.content,addTerminalData:m,onFileSelect:q,handleCreateFile:S,clearTerminalData:w,onShowPreview:H=>L(b.id,H)});case"editor":return e.jsx(Fr,{tabId:l,editorId:b.id});case"ai":return e.jsx(Kr,{socket:n,isConnected:a,chatId:b.id,tabId:l,content:b.content,addTerminalData:m,handleCreateFile:S,clearTerminalData:w,onShowPreview:H=>L(b.id,H)});case"preview":return e.jsx(Ur,{codeBlocks:b.preview});default:return null}},B=b=>{i(b,"terminal",""),w(l,b)},Y=b=>{i(b,"ai",""),w(l,b)};return e.jsxs("div",{ref:h,className:`relative h-full flex min-w-0 min-h-0 ${t.direction==="horizontal"?"flex-col":"flex-row"}`,onFocus:W,tabIndex:0,onContextMenu:M,style:{width:`${N}%`},children:[e.jsx("div",{className:"w-full h-full",children:K(t)}),!d&&e.jsx("button",{className:"absolute top-2 right-2 p-1 bg-[--darkGrayColor] rounded hover:bg-[--darkGrayColor] z-10",onClick:()=>s(t.id),"aria-label":"Close pane",children:e.jsx(ke,{})}),O&&e.jsxs("div",{className:"fixed bg-opacity-50 bg-gradient-to-b from-[--bgGradientStart] to-[--bgGradientEnd] shadow-md rounded-md py-2 z-50",style:{top:O.y,left:O.x},children:[e.jsx("button",{className:"block w-full text-left px-4 py-2 hover:bg-[--primaryTextColor] hover:text-[--darkGrayColor]",onClick:()=>o(t.id,"vertical"),children:"Split Vertical"}),e.jsx("hr",{className:"my-2"}),e.jsxs("button",{className:"block w-full text-left px-4 py-2 hover:bg-[--primaryTextColor] hover:text-[--darkGrayColor]",onClick:()=>B(t.id),children:[e.jsx(Ft,{className:"inline mr-2"})," Open Terminal"]}),e.jsxs("button",{className:"block w-full text-left px-4 py-2 hover:bg-[--primaryTextColor] hover:text-[--darkGrayColor]",onClick:()=>Y(t.id),children:[e.jsx(Bt,{className:"inline mr-2"})," AI Chat"]}),e.jsxs("button",{className:"block w-full text-left px-4 py-2 hover:bg-[--primaryTextColor] hover:text-[--darkGrayColor]",onClick:J,children:[e.jsx(Kt,{className:"inline mr-2"})," Open File"]})]}),!d&&!G&&e.jsx("div",{ref:f,className:"absolute top-0 right-0 bottom-0 w-1 bg-[--iconColor] cursor-col-resize",onMouseDown:j})]})},Yr=({activeTabId:t,tabContents:o,socket:s,isConnected:n,onSplit:a,onClose:i,onUpdateChild:l,addTerminalData:m,addTabCreateFile:d,clearTerminalData:p,tabs:w,addPreviewCode:A,splitChildAndAddPreview:N})=>{const G=o[t],[L,P]=r.useState({}),U=r.useRef(null),g=r.useCallback(u=>{if(u.length===0)return;const h=100/u.length,f=u.reduce((j,M)=>(j[M.id]=h,j),{});P(f)},[]),D=r.useCallback(u=>{var f;i(t,u);const h=((f=o[t])==null?void 0:f.children.filter(j=>j.id!==u))||[];g(h)},[t,i,o,g]),W=r.useCallback((u,h)=>{var j;a(t,u,h);const f=((j=o[t])==null?void 0:j.children)||[];g(f)},[t,a,o,g]),O=r.useCallback((u,h,f)=>{l(t,u,{contentType:h},f)},[t,l]),$=r.useCallback((u,h="terminal")=>d(u,h),[d]),V=r.useCallback((u,h)=>{P(f=>{var Y,b;const j=((Y=o[t])==null?void 0:Y.children)||[],M=j.findIndex(H=>H.id===u);if(M===-1||M===j.length-1)return f;const I=((b=U.current)==null?void 0:b.offsetWidth)||1,q=h/I*100,J=f[u]||100/j.length,S=j[M+1].id,z=f[S]||100/j.length,K=Math.max(10,Math.min(90,J+q)),B=Math.max(10,Math.min(90,z-q));return{...f,[u]:K,[S]:B}})},[t,o]),x=r.useCallback((u,h)=>{N(t,u,"vertical",h)},[t,N]),k=u=>{var f;const h=100/u.length;return e.jsx("div",{className:`flex ${((f=u[0])==null?void 0:f.direction)==="horizontal"?"flex-col":"flex-row"} w-full h-full overflow-auto hide-scrollbar`,children:u.map((j,M)=>e.jsx(Ke.Fragment,{children:e.jsx(qr,{child:j,onSplit:W,onClose:D,onChangeContent:O,socket:s,isConnected:n,tabId:t,addTerminalData:m,isRootLevel:u.length===1,onAddTab:$,clearTerminalData:p,onResize:V,width:L[j.id]||h,isLastPane:M===u.length-1,onShowPreview:x})},j.id))})};return e.jsx("div",{ref:U,className:"flex flex-grow h-full w-full",children:G&&k(G.children)})};function Xr(){const{socket:t,isConnected:o,sendMessage:s}=it("http://127.0.0.1:5000/"),{tabs:n,activeTabId:a,addTab:i,removeTab:l,handleTabChange:m,splitChild:d,closeChild:p,updateChildData:w,updateTabName:A,addTerminalData:N,addTabAndReturnId:G,clearTerminalData:L,addPreviewCode:P,splitChildAndAddPreview:U}=We(),[g,D]=r.useState(!1),W=O=>{D(O)};return n.find(O=>O.id===a)||n[0],r.useEffect(()=>{if(!t||!o)return;localStorage.getItem("selected")==="true"?t.emit("model_selected",{selected:!0}):(t.emit("model_selected",{selected:!1}),t.emit("get_current_model"))},[t,o]),e.jsxs("div",{className:`flex flex-col min-h-screen z-0 relative bg-opacity-50 bg-gradient-to-b from-[--bgGradientStart] to-[--bgGradientEnd] ${g?"pr-80 transition-[padding-right]":"transition-[padding-right]"} font-mono `,children:[e.jsx(jr,{onTabChange:m,onAddTab:i,onTabRemove:l,tabs:n,activeTabId:a,setActiveTab:m,isSliderOpen:g,setIsSliderOpen:W,socket:t,isConnected:o,sendMessage:s,updateTabName:A}),e.jsx("div",{className:"flex z-0 bg-opacity-50 bg-gradient-to-b from-[--bgGradientStart] to-[--bgGradientEnd] text-[--textColor] overflow-y-auto h-[calc(100vh-40px)] pt-5 w-full",children:e.jsx(Yr,{activeTabId:a,tabContents:n.reduce((O,$)=>(O[$.id]={name:$.name,children:$.children},O),{}),socket:t,isConnected:o,onSplit:d,onClose:p,onUpdateChild:w,addTerminalData:N,addTabCreateFile:G,clearTerminalData:L,tabs:n,addPreviewCode:P,splitChildAndAddPreview:U})})]})}const Zr=r.createContext(null),Qr=({children:t})=>{const[o,s]=r.useState(!1),n=()=>s(!0),a=()=>s(!1);return e.jsx(Zr.Provider,{value:{isLeftSliderOpen:o,openLeftSlider:n,closeLeftSlider:a},children:t})},es={keys:new Set},ts=r.createContext(es),rs=({children:t})=>{const[o,s]=r.useState(new Set),{triggerListener:n}=r.useContext(Ce),a=r.useCallback(l=>{const m=new Set([...Array.from(o),l.key.toLocaleLowerCase()]);n(m),s(m)},[o,n]),i=r.useCallback(l=>{const m=new Set([...Array.from(o).filter(d=>d!==l.key.toLocaleLowerCase())]);s(m)},[o]);return r.useEffect(()=>(window.addEventListener("keydown",a),window.addEventListener("keyup",i),()=>{window.removeEventListener("keydown",a),window.removeEventListener("keyup",i)}),[a,i]),e.jsx(ts.Provider,{value:{keys:o},children:t})},ss=vt.createRoot(document.getElementById("root"));ss.render(e.jsx(Ke.StrictMode,{children:e.jsx(pr,{children:e.jsx(rs,{children:e.jsx(Vr,{children:e.jsx(er,{children:e.jsx(Qr,{children:e.jsx(Xr,{})})})})})})}));
//# sourceMappingURL=index-Dm3n66-C.js.map
